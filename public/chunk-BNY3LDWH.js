import{a as u}from"./chunk-37WAIENX.js";import{Q as j}from"./chunk-AWTQUO7P.js";import{h as f}from"./chunk-FK42CRUA.js";var d=class c{guardarPuntaje(e,n,t){return f(this,null,function*(){if(!e)return;let{data:o}=yield u.from("Puntajes").select("*").eq("user_id",e.id).eq("juego",n),s=o?.[0],a=s?.puntaje;(!s||(n==="buscaminas"?t<a:t>a))&&(s&&(yield u.from("Puntajes").delete().eq("id",s.id)),yield u.from("Puntajes").insert({user_id:e.id,juego:n,puntaje:t,fecha:new Date().toISOString()}))})}obtenerRanking(e){return f(this,null,function*(){let{data:n,error:t}=yield u.from("Puntajes").select("puntaje, fecha, user_id, Usuarios(nombre)").eq("juego",e);if(t)throw t;let o=new Map;for(let a of n){let r=Array.isArray(a.Usuarios)?a.Usuarios[0]:a.Usuarios,i={puntaje:a.puntaje,fecha:a.fecha,user_id:a.user_id,Usuarios:r?{nombre:r.nombre}:void 0},m=o.get(i.user_id);(!m||(e==="buscaminas"?i.puntaje<m.puntaje:i.puntaje>m.puntaje))&&o.set(i.user_id,i)}let s=Array.from(o.values());return s.sort((a,r)=>e==="buscaminas"?a.puntaje-r.puntaje:r.puntaje-a.puntaje),s})}static \u0275fac=function(n){return new(n||c)};static \u0275prov=j({token:c,factory:c.\u0275fac,providedIn:"root"})};export{d as a};
