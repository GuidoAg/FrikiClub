import{a as z,c as k}from"./chunk-GOHWGIN5.js";import{a as O}from"./chunk-BNY3LDWH.js";import{a as D}from"./chunk-FF7POJ4O.js";import"./chunk-37WAIENX.js";import"./chunk-LJ5XHLMQ.js";import{k as T,l as F,p as M}from"./chunk-ODFDANH7.js";import{Ab as n,Bb as j,Cb as u,Db as A,Ea as w,Ha as s,Ma as b,Sa as E,Xa as v,ca as x,da as _,db as m,kb as r,lb as a,mb as S,n as y,nb as C,rb as I,sa as d,sb as h}from"./chunk-AWTQUO7P.js";import{h as g}from"./chunk-FK42CRUA.js";function L(c,t){if(c&1&&(r(0,"span",9),n(1),a()),c&2){let e=t.$implicit;s(),u(" ",e," ")}}function V(c,t){if(c&1){let e=C();r(0,"button",10),I("click",function(){let l=x(e).$implicit,o=h();return _(o.seleccionarLetra(l))}),n(1),a()}if(c&2){let e=t.$implicit,i=h();m("disabled",i.letrasUsadas().includes(e)||i.juegoTerminado()),s(),u(" ",e," ")}}function R(c,t){if(c&1){let e=C();r(0,"div",11)(1,"h5"),n(2,"\u{1F635} \xA1Te ahorcaron!"),a(),r(3,"p"),n(4,"La palabra era: "),r(5,"strong"),n(6),a()(),r(7,"p"),n(8),a(),r(9,"button",12),I("click",function(){x(e);let l=h();return _(l.reiniciar())}),n(10,"\u{1F501} Volver a empezar"),a()()}if(c&2){let e=h();s(6),j(e.palabraCorrecta()),s(2),A("Aciertos: ",e.aciertos()," | Tiempo: ",e.tiempo(),"s")}}var U=class c{constructor(t,e,i){this.http=t;this.puntajeService=e;this.userService=i;this.preloadImagenes(),this.preloadAudios(),this.iniciarTemporizador(),this.preloadDiccionarios().then(()=>{this.iniciarJuego()})}vidas=d(6);tiempo=d(0);aciertos=d(0);juegoTerminado=d(!1);palabra=d([]);letrasUsadas=d([]);letraActual=d("");mostrarResumen=d(!1);palabraCorrecta=d("");temporizadorId=null;abecedario="ABCDEFGHIJKLMN\xD1OPQRSTUVWXYZ".split("");imagenesPreCargadas=[];audios={};diccionarios={};preloadImagenes(){for(let t=0;t<=6;t++){let e=new Image;e.src=`assets/imagenes/${t}.png`,this.imagenesPreCargadas.push(e)}}preloadAudios(){["win","punto"].forEach(e=>{let i=new Audio(`assets/sounds/${e}.mp3`);i.load(),this.audios[e]=i})}reproducirSonido(t){let e=this.audios[t];e&&(e.currentTime=0,e.play().catch(i=>console.error("Error sonido:",i)))}preloadDiccionarios(){return g(this,null,function*(){let t="abcdefghijklmnopqrstuvwxyz".split("");for(let e of t){let i=yield this.cargarPalabrasPorLetra(e);this.diccionarios[e]=i}})}iniciarJuego(){return g(this,null,function*(){let t=this.getLetraAleatoria(),e=this.diccionarios[t]||["pepe"],i=this.aciertos(),l=10;i===0?l=4:i===1?l=5:i===2&&(l=6);let o=e.filter(f=>{let P=this.limpiarPalabra(f);return P.length>=3&&P.length<=l});o.length===0&&(o=e);let p=this.limpiarPalabra(this.getPalabraAleatoria(o));this.palabraCorrecta.set(p.toUpperCase()),this.palabra.set(p.toUpperCase().split("").map(f=>"_")),this.juegoTerminado.set(!1),this.mostrarResumen.set(!1),this.vidas.set(6),this.letrasUsadas.set([])})}getLetraAleatoria(){let t="abc";return t[Math.floor(Math.random()*t.length)]}cargarPalabrasPorLetra(t){return g(this,null,function*(){let e=`assets/diccionario/${t}.txt`;try{return((yield y(this.http.get(e,{responseType:"text"})))?.split(`
`)??[]).slice(1).filter(o=>/^[a-zA-ZñÑáéíóúÁÉÍÓÚüÜ]+$/.test(o))}catch{return["angular"]}})}limpiarPalabra(t){return t.split(",")[0].split(" ")[0].normalize("NFD").replace(/[\u0300-\u036f]/g,"")}getPalabraAleatoria(t){return t[Math.floor(Math.random()*t.length)]}seleccionarLetra(t){if(this.juegoTerminado())return;let e=this.letrasUsadas();if(e.includes(t))return;this.letrasUsadas.set([...e,t]);let i=this.palabraCorrecta(),l=this.palabra();if(i.includes(t)){let o=l.map((p,f)=>i[f]===t?t:p);this.palabra.set(o),o.includes("_")||(this.aciertos.update(p=>p+1),this.reproducirSonido("punto"),setTimeout(()=>this.iniciarJuego(),400))}else this.vidas.update(o=>o-1),this.vidas()===0&&this.finalizarJuego()}finalizarJuego(){this.temporizadorId&&(clearInterval(this.temporizadorId),this.temporizadorId=null),this.juegoTerminado.set(!0),this.mostrarResumen.set(!0),this.reproducirSonido("win"),this.guardarPuntajeFinal()}guardarPuntajeFinal(){return g(this,null,function*(){let t=this.userService.getCurrentUser(),e=this.aciertos();try{t&&(yield this.puntajeService.guardarPuntaje(t,"ahorcado",e),console.log("Puntaje guardado correctamente"))}catch(i){console.error("Error al guardar el puntaje:",i)}})}reiniciar(){this.aciertos.set(0),this.tiempo.set(0),this.iniciarTemporizador(),this.iniciarJuego()}iniciarTemporizador(){this.temporizadorId||(this.temporizadorId=setInterval(()=>{this.tiempo.update(t=>t+1)},1e3))}get imagenActual(){return`assets/imagenes/${6-this.vidas()}.png`}static \u0275fac=function(e){return new(e||c)(b(z),b(O),b(D))};static \u0275cmp=E({type:c,selectors:[["friki-club-ahorcado"]],decls:21,vars:7,consts:[[1,"wrapper","bg-white","p-4","rounded","shadow-lg","text-center"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"imagen-container","mb-3"],["alt","Estado del ahorcado",1,"img-fluid",3,"src"],[1,"palabra","mb-3","d-flex","justify-content-center","gap-2","flex-wrap"],["class","letra border border-dark px-2 py-1 rounded",4,"ngFor","ngForOf"],[1,"teclado","d-flex","flex-wrap","justify-content-center","gap-2"],["class","btn btn-outline-dark",3,"disabled","click",4,"ngFor","ngForOf"],["class","alert alert-info mt-4",4,"ngIf"],[1,"letra","border","border-dark","px-2","py-1","rounded"],[1,"btn","btn-outline-dark",3,"click","disabled"],[1,"alert","alert-info","mt-4"],[1,"btn","btn-primary","mt-2",3,"click"]],template:function(e,i){e&1&&(r(0,"div",0)(1,"div",1)(2,"div")(3,"strong"),n(4,"\u2764\uFE0F"),a(),n(5),a(),r(6,"div")(7,"strong"),n(8,"\u23F1\uFE0F"),a(),n(9),a(),r(10,"div")(11,"strong"),n(12,"\u2714\uFE0F"),a(),n(13),a()(),r(14,"div",2),S(15,"img",3),a(),r(16,"div",4),v(17,L,2,1,"span",5),a(),r(18,"div",6),v(19,V,2,2,"button",7),a(),v(20,R,11,3,"div",8),a()),e&2&&(s(5),u(" Vidas: ",i.vidas(),""),s(4),u(" Tiempo: ",i.tiempo(),"s"),s(4),u(" Aciertos: ",i.aciertos(),""),s(2),m("src",i.imagenActual,w),s(2),m("ngForOf",i.palabra()),s(2),m("ngForOf",i.abecedario),s(),m("ngIf",i.mostrarResumen()))},dependencies:[M,T,F,k],styles:[".wrapper[_ngcontent-%COMP%]{max-width:600px;margin:3rem auto}.imagen-container[_ngcontent-%COMP%]{max-height:200px}.imagen-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:200px;object-fit:contain}.palabra[_ngcontent-%COMP%]   .letra[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;width:40px;height:50px;display:inline-flex;justify-content:center;align-items:center;background-color:#f8f9fa;border:2px solid #343a40;border-radius:8px}.teclado[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:40px;height:40px;font-weight:700}"]})};export{U as AhorcadoComponent};
