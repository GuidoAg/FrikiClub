import{b as V,d,f as M,g as O,j as T,k as w,l as q,m as G,n as D,o as P,p as B,q as R,r as U}from"./chunk-6MB74IZP.js";import{a as $}from"./chunk-PCYU5DIU.js";import{a as j}from"./chunk-37WAIENX.js";import"./chunk-LJ5XHLMQ.js";import{j as k,k as N,l as I,p as A}from"./chunk-ODFDANH7.js";import{Ab as o,Bb as E,Ha as a,Jb as x,Kb as c,Ma as b,Sa as F,Xa as p,ca as _,da as y,db as s,kb as i,lb as n,mb as u,nb as S,rb as h,sb as f}from"./chunk-AWTQUO7P.js";import{h as C}from"./chunk-FK42CRUA.js";var v=(r,l)=>({"is-invalid":r,"is-valid":l}),L=r=>({"is-invalid":r});function z(r,l){if(r&1){let t=S();i(0,"div")(1,"input",21),h("change",function(m){_(t);let g=f();return y(g.onCheckboxChange(m))}),n(),i(2,"label",22),o(3),n()()}if(r&2){let t=l.$implicit,e=f();a(),s("id",t)("value",t)("checked",e.f.pregunta2.value.includes(t)),a(),s("for",t),a(),E(t)}}function Q(r,l){r&1&&(i(0,"div",23),o(1," Seleccion\xE1 al menos una opci\xF3n. "),n())}function J(r,l){if(r&1&&(i(0,"div"),u(1,"input",24),i(2,"label",22),o(3),n()()),r&2){let t=l.$implicit,e=f();a(),s("id","radio_"+t)("value",t)("ngClass",x(5,L,e.enviado&&e.f.pregunta3.invalid)),a(),s("for","radio_"+t),a(),E(t)}}function K(r,l){r&1&&(i(0,"div",25),o(1," Seleccion\xE1 una opci\xF3n. "),n())}function W(r,l){r&1&&(i(0,"div",26),o(1," \xA1Gracias por completar la encuesta! "),n())}var H=class r{constructor(l,t){this.fb=l;this.userService=t}encuestaForm;enviado=!1;guardadoExitoso=!1;opcionesCheckbox=["Busca minas","Ahorcado","Preguntado","Mayor menor"];opcionesRadio=["S\xED","No","Tal vez"];ngOnInit(){this.encuestaForm=this.fb.group({nombre:["",d.required],edad:["",[d.required,d.min(18),d.max(99)]],telefono:["",[d.required,d.pattern(/^\d{1,10}$/)]],pregunta1:["",d.required],pregunta2:this.fb.array([],d.required),pregunta3:["",d.required]})}get f(){return this.encuestaForm.controls}onCheckboxChange(l){let t=this.encuestaForm.get("pregunta2"),e=l.target;if(e.checked)t.push(this.fb.control(e.value));else{let m=t.controls.findIndex(g=>g.value===e.value);m>=0&&t.removeAt(m)}t.updateValueAndValidity()}enviar(){return C(this,null,function*(){if(this.enviado=!0,this.guardadoExitoso=!1,this.encuestaForm.invalid)return;let l=this.userService.getCurrentUser();if(!l){alert("No se encontr\xF3 el usuario logueado");return}let t={usuario_id:l.id,nombre:this.f.nombre.value,edad:this.f.edad.value,telefono:this.f.telefono.value,pregunta1:this.f.pregunta1.value,pregunta2:this.f.pregunta2.value,pregunta3:this.f.pregunta3.value},{error:e}=yield j.from("Encuestas").insert([t]);if(e)console.error("Error al guardar encuesta:",e.message),alert("Hubo un error al guardar la encuesta");else{this.guardadoExitoso=!0,this.encuestaForm.reset(),this.enviado=!1;let m=this.encuestaForm.get("pregunta2");for(;m.length;)m.removeAt(0)}})}static \u0275fac=function(t){return new(t||r)(b(B),b($))};static \u0275cmp=F({type:r,selectors:[["friki-club-home"]],decls:42,vars:22,consts:[[1,"encuesta-bg"],[1,"container","mt-4"],[1,"mb-4"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","nombre",1,"form-label"],["id","nombre","type","text","formControlName","nombre",1,"form-control",3,"ngClass"],[1,"invalid-feedback"],["for","edad",1,"form-label"],["id","edad","type","number","formControlName","edad",1,"form-control",3,"ngClass"],["for","telefono",1,"form-label"],["id","telefono","type","number","formControlName","telefono","maxlength","10",1,"form-control",3,"ngClass"],["for","pregunta1",1,"form-label"],["id","pregunta1","rows","3","formControlName","pregunta1",1,"form-control",3,"ngClass"],["for","pregunta2",1,"form-label","d-block"],[4,"ngFor","ngForOf"],["class","text-danger mt-1",4,"ngIf"],["for","pregunta3",1,"form-label","d-block"],["class","invalid-feedback d-block",4,"ngIf"],["type","submit",1,"btn","btn-primary"],["class","alert alert-success mt-3",4,"ngIf"],["type","checkbox",3,"change","id","value","checked"],[1,"ms-1",3,"for"],[1,"text-danger","mt-1"],["type","radio","formControlName","pregunta3",3,"id","value","ngClass"],[1,"invalid-feedback","d-block"],[1,"alert","alert-success","mt-3"]],template:function(t,e){t&1&&(i(0,"div",0)(1,"div",1)(2,"h2",2),o(3,"Encuesta"),n(),i(4,"form",3),h("ngSubmit",function(){return e.enviar()}),i(5,"div",4)(6,"label",5),o(7,"Nombre y Apellido"),n(),u(8,"input",6),i(9,"div",7),o(10,"El nombre es obligatorio."),n()(),i(11,"div",4)(12,"label",8),o(13,"Edad"),n(),u(14,"input",9),i(15,"div",7),o(16,"Debes tener entre 18 y 99 a\xF1os."),n()(),i(17,"div",4)(18,"label",10),o(19,"Telefono"),n(),u(20,"input",11),i(21,"div",7),o(22,"Ingrese un numero menor a 10 digitos"),n()(),i(23,"div",4)(24,"label",12),o(25,"Opinion y recomendacion para la pagina"),n(),u(26,"textarea",13),i(27,"div",7),o(28,"Esta pregunta es obligatoria."),n()(),i(29,"div",4)(30,"label",14),o(31,"Que juegos recomendarias"),n(),p(32,z,4,5,"div",15)(33,Q,2,0,"div",16),n(),i(34,"div",4)(35,"label",17),o(36,"\xBFVas a volver?"),n(),p(37,J,4,7,"div",15)(38,K,2,0,"div",18),n(),i(39,"button",19),o(40,"Enviar encuesta"),n()(),p(41,W,2,0,"div",20),n()()),t&2&&(a(4),s("formGroup",e.encuestaForm),a(4),s("ngClass",c(10,v,e.enviado&&e.f.nombre.invalid,e.f.nombre.valid)),a(6),s("ngClass",c(13,v,e.enviado&&e.f.edad.invalid,e.f.edad.valid)),a(6),s("ngClass",c(16,v,e.enviado&&e.f.telefono.invalid,e.f.telefono.valid)),a(6),s("ngClass",c(19,v,e.enviado&&e.f.pregunta1.invalid,e.f.pregunta1.valid)),a(6),s("ngForOf",e.opcionesCheckbox),a(),s("ngIf",e.enviado&&(e.f.pregunta2.errors==null?null:e.f.pregunta2.errors.required)),a(4),s("ngForOf",e.opcionesRadio),a(),s("ngIf",e.enviado&&e.f.pregunta3.invalid),a(3),s("ngIf",e.guardadoExitoso))},dependencies:[A,k,N,I,U,T,V,w,q,M,O,P,G,D,R],styles:[".encuesta-bg[_ngcontent-%COMP%]{min-height:100vh;background-color:#c5c5c5;padding-top:2rem;padding-bottom:2rem;width:100%}html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{height:100%;margin:0;padding:0}"]})};export{H as EncuestaComponent};
