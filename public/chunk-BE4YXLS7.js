import{b as Hr,c as Wr,f as Us,g as zr}from"./chunk-LJ5XHLMQ.js";import{b as Qt}from"./chunk-U4Q7EWK3.js";import{Gb as de,Ka as Yt,La as w,N as st,O as ue,Ob as qr,P as nt,Q as ot,Qb as Gr,Rb as B,S as Y,Sa as lt,Sb as fe,Ta as I,Va as L,Ya as Br,aa as at,eb as Xt,f as Rr,fa as Lr,g as Fr,i as Ur,la as X,n as $r,pa as Kt,qb as ct,ra as he,t as Nr}from"./chunk-5R74MMIU.js";import{a as x,b as V,d as N,f as Rs,g as Fs,h}from"./chunk-FK42CRUA.js";var fr=N(dr=>{"use strict";Object.defineProperty(dr,"__esModule",{value:!0});var hr=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};dr.default=hr});var gr=N(Ue=>{"use strict";var xi=Ue&&Ue.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Ue,"__esModule",{value:!0});var bn=xi((zr(),Fs(Us))),Cn=xi(fr()),pr=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=bn.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=Object.assign({},this.headers),this.headers[t]=e,this}then(t,e){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");let r=this.fetch,s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(n=>h(this,null,function*(){var o,a,l;let c=null,u=null,d=null,p=n.status,f=n.statusText;if(n.ok){if(this.method!=="HEAD"){let E=yield n.text();E===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=E:u=JSON.parse(E))}let _=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),v=(a=n.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");_&&v&&v.length>1&&(d=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,d=null,p=406,f="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{let _=yield n.text();try{c=JSON.parse(_),Array.isArray(c)&&n.status===404&&(u=[],c=null,p=200,f="OK")}catch{n.status===404&&_===""?(p=204,f="No Content"):c={message:_}}if(c&&this.isMaybeSingle&&(!((l=c?.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,p=200,f="OK"),c&&this.shouldThrowOnError)throw new Cn.default(c)}return{error:c,data:u,count:d,status:p,statusText:f}}));return this.shouldThrowOnError||(s=s.catch(n=>{var o,a,l;return{error:{message:`${(o=n?.name)!==null&&o!==void 0?o:"FetchError"}: ${n?.message}`,details:`${(a=n?.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(l=n?.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,e)}returns(){return this}overrideTypes(){return this}};Ue.default=pr});var _r=N($e=>{"use strict";var An=$e&&$e.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty($e,"__esModule",{value:!0});var En=An(gr()),mr=class extends En.default{select(t){let e=!1,r=(t??"*").split("").map(s=>/\s/.test(s)&&!e?"":(s==='"'&&(e=!e),s)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:e=!0,nullsFirst:r,foreignTable:s,referencedTable:n=s}={}){let o=n?`${n}.order`:"order",a=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${a?`${a},`:""}${t}.${e?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:r=e}={}){let s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,e,{foreignTable:r,referencedTable:s=r}={}){let n=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${t}`),this.url.searchParams.set(o,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:e=!1,settings:r=!1,buffers:s=!1,wal:n=!1,format:o="text"}={}){var a;let l=[t?"analyze":null,e?"verbose":null,r?"settings":null,s?"buffers":null,n?"wal":null].filter(Boolean).join("|"),c=(a=this.headers.Accept)!==null&&a!==void 0?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${c}"; options=${l};`,o==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};$e.default=mr});var kt=N(Ne=>{"use strict";var Sn=Ne&&Ne.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Ne,"__esModule",{value:!0});var xn=Sn(_r()),vr=class extends xn.default{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}in(t,e){let r=Array.from(new Set(e)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:r,type:s}={}){let n="";s==="plain"?n="pl":s==="phrase"?n="ph":s==="websearch"&&(n="w");let o=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${n}fts${o}.${e}`),this}match(t){return Object.entries(t).forEach(([e,r])=>{this.url.searchParams.append(e,`eq.${r}`)}),this}not(t,e,r){return this.url.searchParams.append(t,`not.${e}.${r}`),this}or(t,{foreignTable:e,referencedTable:r=e}={}){let s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,e,r){return this.url.searchParams.append(t,`${e}.${r}`),this}};Ne.default=vr});var wr=N(Be=>{"use strict";var kn=Be&&Be.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Be,"__esModule",{value:!0});var Le=kn(kt()),yr=class{constructor(t,{headers:e={},schema:r,fetch:s}){this.url=t,this.headers=e,this.schema=r,this.fetch=s}select(t,{head:e=!1,count:r}={}){let s=e?"HEAD":"GET",n=!1,o=(t??"*").split("").map(a=>/\s/.test(a)&&!n?"":(a==='"'&&(n=!n),a)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new Le.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:e,defaultToNull:r=!0}={}){let s="POST",n=[];if(this.headers.Prefer&&n.push(this.headers.Prefer),e&&n.push(`count=${e}`),r||n.push("missing=default"),this.headers.Prefer=n.join(","),Array.isArray(t)){let o=t.reduce((a,l)=>a.concat(Object.keys(l)),[]);if(o.length>0){let a=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",a.join(","))}}return new Le.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:e,ignoreDuplicates:r=!1,count:s,defaultToNull:n=!0}={}){let o="POST",a=[`resolution=${r?"ignore":"merge"}-duplicates`];if(e!==void 0&&this.url.searchParams.set("on_conflict",e),this.headers.Prefer&&a.push(this.headers.Prefer),s&&a.push(`count=${s}`),n||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(t)){let l=t.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){let c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new Le.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:e}={}){let r="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),e&&s.push(`count=${e}`),this.headers.Prefer=s.join(","),new Le.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){let e="DELETE",r=[];return t&&r.push(`count=${t}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new Le.default({method:e,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Be.default=yr});var ki=N(Dt=>{"use strict";Object.defineProperty(Dt,"__esModule",{value:!0});Dt.version=void 0;Dt.version="0.0.0-automated"});var Di=N(Ot=>{"use strict";Object.defineProperty(Ot,"__esModule",{value:!0});Ot.DEFAULT_HEADERS=void 0;var Dn=ki();Ot.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Dn.version}`}});var Ti=N(qe=>{"use strict";var Oi=qe&&qe.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(qe,"__esModule",{value:!0});var On=Oi(wr()),Tn=Oi(kt()),Vn=Di(),br=class i{constructor(t,{headers:e={},schema:r,fetch:s}={}){this.url=t,this.headers=Object.assign(Object.assign({},Vn.DEFAULT_HEADERS),e),this.schemaName=r,this.fetch=s}from(t){let e=new URL(`${this.url}/${t}`);return new On.default(e,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new i(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,e={},{head:r=!1,get:s=!1,count:n}={}){let o,a=new URL(`${this.url}/rpc/${t}`),l;r||s?(o=r?"HEAD":"GET",Object.entries(e).filter(([u,d])=>d!==void 0).map(([u,d])=>[u,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([u,d])=>{a.searchParams.append(u,d)})):(o="POST",l=e);let c=Object.assign({},this.headers);return n&&(c.Prefer=`count=${n}`),new Tn.default({method:o,url:a,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};qe.default=br});var Fi=N(A=>{"use strict";var ve=A&&A.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(A,"__esModule",{value:!0});A.PostgrestError=A.PostgrestBuilder=A.PostgrestTransformBuilder=A.PostgrestFilterBuilder=A.PostgrestQueryBuilder=A.PostgrestClient=void 0;var Vi=ve(Ti());A.PostgrestClient=Vi.default;var Ii=ve(wr());A.PostgrestQueryBuilder=Ii.default;var Pi=ve(kt());A.PostgrestFilterBuilder=Pi.default;var Mi=ve(_r());A.PostgrestTransformBuilder=Mi.default;var ji=ve(gr());A.PostgrestBuilder=ji.default;var Ri=ve(fr());A.PostgrestError=Ri.default;A.default={PostgrestClient:Vi.default,PostgrestQueryBuilder:Ii.default,PostgrestFilterBuilder:Pi.default,PostgrestTransformBuilder:Mi.default,PostgrestBuilder:ji.default,PostgrestError:Ri.default}});var ii=(()=>{class i{_renderer;_elementRef;onChange=e=>{};onTouched=()=>{};constructor(e,r){this._renderer=e,this._elementRef=r}setProperty(e,r){this._renderer.setProperty(this._elementRef.nativeElement,e,r)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static \u0275fac=function(r){return new(r||i)(w(Yt),w(Kt))};static \u0275dir=I({type:i})}return i})(),Ns=(()=>{class i extends ii{static \u0275fac=(()=>{let e;return function(s){return(e||(e=Lr(i)))(s||i)}})();static \u0275dir=I({type:i,features:[L]})}return i})(),rr=new Y("");var Ls={provide:rr,useExisting:ue(()=>si),multi:!0};function Bs(){let i=Qt()?Qt().getUserAgent():"";return/android (\d+)/.test(i.toLowerCase())}var qs=new Y(""),si=(()=>{class i extends ii{_compositionMode;_composing=!1;constructor(e,r,s){super(e,r),this._compositionMode=s,this._compositionMode==null&&(this._compositionMode=!Bs())}writeValue(e){let r=e??"";this.setProperty("value",r)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static \u0275fac=function(r){return new(r||i)(w(Yt),w(Kt),w(qs,8))};static \u0275dir=I({type:i,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,s){r&1&&ct("input",function(o){return s._handleInput(o.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(o){return s._compositionEnd(o.target.value)})},standalone:!1,features:[de([Ls]),L]})}return i})();function ir(i){return i==null||sr(i)===0}function sr(i){return i==null?null:Array.isArray(i)||typeof i=="string"?i.length:i instanceof Set?i.size:null}var wt=new Y(""),bt=new Y(""),Gs=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Jr=class{static min(t){return Hs(t)}static max(t){return Ws(t)}static required(t){return zs(t)}static requiredTrue(t){return Js(t)}static email(t){return Ks(t)}static minLength(t){return Ys(t)}static maxLength(t){return Xs(t)}static pattern(t){return Qs(t)}static nullValidator(t){return ni()}static compose(t){return hi(t)}static composeAsync(t){return di(t)}};function Hs(i){return t=>{if(t.value==null||i==null)return null;let e=parseFloat(t.value);return!isNaN(e)&&e<i?{min:{min:i,actual:t.value}}:null}}function Ws(i){return t=>{if(t.value==null||i==null)return null;let e=parseFloat(t.value);return!isNaN(e)&&e>i?{max:{max:i,actual:t.value}}:null}}function zs(i){return ir(i.value)?{required:!0}:null}function Js(i){return i.value===!0?null:{required:!0}}function Ks(i){return ir(i.value)||Gs.test(i.value)?null:{email:!0}}function Ys(i){return t=>{let e=t.value?.length??sr(t.value);return e===null||e===0?null:e<i?{minlength:{requiredLength:i,actualLength:e}}:null}}function Xs(i){return t=>{let e=t.value?.length??sr(t.value);return e!==null&&e>i?{maxlength:{requiredLength:i,actualLength:e}}:null}}function Qs(i){if(!i)return ni;let t,e;return typeof i=="string"?(e="",i.charAt(0)!=="^"&&(e+="^"),e+=i,i.charAt(i.length-1)!=="$"&&(e+="$"),t=new RegExp(e)):(e=i.toString(),t=i),r=>{if(ir(r.value))return null;let s=r.value;return t.test(s)?null:{pattern:{requiredPattern:e,actualValue:s}}}}function ni(i){return null}function oi(i){return i!=null}function ai(i){return Br(i)?Ur(i):i}function li(i){let t={};return i.forEach(e=>{t=e!=null?x(x({},t),e):t}),Object.keys(t).length===0?null:t}function ci(i,t){return t.map(e=>e(i))}function Zs(i){return!i.validate}function ui(i){return i.map(t=>Zs(t)?t:e=>t.validate(e))}function hi(i){if(!i)return null;let t=i.filter(oi);return t.length==0?null:function(e){return li(ci(e,t))}}function nr(i){return i!=null?hi(ui(i)):null}function di(i){if(!i)return null;let t=i.filter(oi);return t.length==0?null:function(e){let r=ci(e,t).map(ai);return Nr(r).pipe($r(li))}}function or(i){return i!=null?di(ui(i)):null}function Kr(i,t){return i===null?[t]:Array.isArray(i)?[...i,t]:[i,t]}function fi(i){return i._rawValidators}function pi(i){return i._rawAsyncValidators}function Zt(i){return i?Array.isArray(i)?i:[i]:[]}function ht(i,t){return Array.isArray(i)?i.includes(t):i===t}function Yr(i,t){let e=Zt(t);return Zt(i).forEach(s=>{ht(e,s)||e.push(s)}),e}function Xr(i,t){return Zt(t).filter(e=>!ht(i,e))}var dt=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=nr(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=or(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t=void 0){this.control&&this.control.reset(t)}hasError(t,e){return this.control?this.control.hasError(t,e):!1}getError(t,e){return this.control?this.control.getError(t,e):null}},q=class extends dt{name;get formDirective(){return null}get path(){return null}},Q=class extends dt{_parent=null;name=null;valueAccessor=null},ft=class{_cd;constructor(t){this._cd=t}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},en={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Ro=V(x({},en),{"[class.ng-submitted]":"isSubmitted"}),Fo=(()=>{class i extends ft{constructor(e){super(e)}static \u0275fac=function(r){return new(r||i)(w(Q,2))};static \u0275dir=I({type:i,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,s){r&2&&Xt("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},standalone:!1,features:[L]})}return i})(),Uo=(()=>{class i extends ft{constructor(e){super(e)}static \u0275fac=function(r){return new(r||i)(w(q,10))};static \u0275dir=I({type:i,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,s){r&2&&Xt("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},standalone:!1,features:[L]})}return i})();var Oe="VALID",ut="INVALID",pe="PENDING",Te="DISABLED",J=class{},pt=class extends J{value;source;constructor(t,e){super(),this.value=t,this.source=e}},Ie=class extends J{pristine;source;constructor(t,e){super(),this.pristine=t,this.source=e}},Pe=class extends J{touched;source;constructor(t,e){super(),this.touched=t,this.source=e}},ge=class extends J{status;source;constructor(t,e){super(),this.status=t,this.source=e}},gt=class extends J{source;constructor(t){super(),this.source=t}},mt=class extends J{source;constructor(t){super(),this.source=t}};function ar(i){return(Ct(i)?i.validators:i)||null}function tn(i){return Array.isArray(i)?nr(i):i||null}function lr(i,t){return(Ct(t)?t.asyncValidators:i)||null}function rn(i){return Array.isArray(i)?or(i):i||null}function Ct(i){return i!=null&&!Array.isArray(i)&&typeof i=="object"}function gi(i,t,e){let r=i.controls;if(!(t?Object.keys(r):r).length)throw new st(1e3,"");if(!r[e])throw new st(1001,"")}function mi(i,t,e){i._forEachChild((r,s)=>{if(e[s]===void 0)throw new st(1002,"")})}var me=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(t,e){this._assignValidators(t),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get status(){return B(this.statusReactive)}set status(t){B(()=>this.statusReactive.set(t))}_status=fe(()=>this.statusReactive());statusReactive=he(void 0);get valid(){return this.status===Oe}get invalid(){return this.status===ut}get pending(){return this.status==pe}get disabled(){return this.status===Te}get enabled(){return this.status!==Te}errors;get pristine(){return B(this.pristineReactive)}set pristine(t){B(()=>this.pristineReactive.set(t))}_pristine=fe(()=>this.pristineReactive());pristineReactive=he(!0);get dirty(){return!this.pristine}get touched(){return B(this.touchedReactive)}set touched(t){B(()=>this.touchedReactive.set(t))}_touched=fe(()=>this.touchedReactive());touchedReactive=he(!1);get untouched(){return!this.touched}_events=new Rr;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(Yr(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(Yr(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(Xr(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(Xr(t,this._rawAsyncValidators))}hasValidator(t){return ht(this._rawValidators,t)}hasAsyncValidator(t){return ht(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){let e=this.touched===!1;this.touched=!0;let r=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsTouched(V(x({},t),{sourceControl:r})),e&&t.emitEvent!==!1&&this._events.next(new Pe(!0,r))}markAllAsTouched(t={}){this.markAsTouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsTouched(t))}markAsUntouched(t={}){let e=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=t.sourceControl??this;this._forEachChild(s=>{s.markAsUntouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:r})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,r),e&&t.emitEvent!==!1&&this._events.next(new Pe(!1,r))}markAsDirty(t={}){let e=this.pristine===!0;this.pristine=!1;let r=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsDirty(V(x({},t),{sourceControl:r})),e&&t.emitEvent!==!1&&this._events.next(new Ie(!1,r))}markAsPristine(t={}){let e=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=t.sourceControl??this;this._forEachChild(s=>{s.markAsPristine({onlySelf:!0,emitEvent:t.emitEvent})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t,r),e&&t.emitEvent!==!1&&this._events.next(new Ie(!0,r))}markAsPending(t={}){this.status=pe;let e=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new ge(this.status,e)),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.markAsPending(V(x({},t),{sourceControl:e}))}disable(t={}){let e=this._parentMarkedDirty(t.onlySelf);this.status=Te,this.errors=null,this._forEachChild(s=>{s.disable(V(x({},t),{onlySelf:!0}))}),this._updateValue();let r=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new pt(this.value,r)),this._events.next(new ge(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(V(x({},t),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(s=>s(!0))}enable(t={}){let e=this._parentMarkedDirty(t.onlySelf);this.status=Oe,this._forEachChild(r=>{r.enable(V(x({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(V(x({},t),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(t,e){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine({},e),this._parent._updateTouched({},e))}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Oe||this.status===pe)&&this._runAsyncValidator(r,t.emitEvent)}let e=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new pt(this.value,e)),this._events.next(new ge(this.status,e)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(V(x({},t),{sourceControl:e}))}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Te:Oe}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t,e){if(this.asyncValidator){this.status=pe,this._hasOwnPendingAsyncValidator={emitEvent:e!==!1};let r=ai(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(s=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(s,{emitEvent:e,shouldHaveEmitted:t})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let t=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,t}return!1}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(e.emitEvent!==!1,this,e.shouldHaveEmitted)}get(t){let e=t;return e==null||(Array.isArray(e)||(e=e.split(".")),e.length===0)?null:e.reduce((r,s)=>r&&r._find(s),this)}getError(t,e){let r=e?this.get(e):this;return r&&r.errors?r.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t,e,r){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),(t||r)&&this._events.next(new ge(this.status,e)),this._parent&&this._parent._updateControlsErrors(t,e,r)}_initObservables(){this.valueChanges=new X,this.statusChanges=new X}_calculateStatus(){return this._allControlsDisabled()?Te:this.errors?ut:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(pe)?pe:this._anyControlsHaveStatus(ut)?ut:Oe}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t,e){let r=!this._anyControlsDirty(),s=this.pristine!==r;this.pristine=r,this._parent&&!t.onlySelf&&this._parent._updatePristine(t,e),s&&this._events.next(new Ie(this.pristine,e))}_updateTouched(t={},e){this.touched=this._anyControlsTouched(),this._events.next(new Pe(this.touched,e)),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,e)}_onDisabledChange=[];_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){Ct(t)&&t.updateOn!=null&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){let e=this._parent&&this._parent.dirty;return!t&&!!e&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=tn(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=rn(this._rawAsyncValidators)}},_e=class extends me{constructor(t,e,r){super(ar(e),lr(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,r={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,r={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){mi(this,!0,t),Object.keys(t).forEach(r=>{gi(this,!0,r),this.controls[r].setValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t!=null&&(Object.keys(t).forEach(r=>{let s=this.controls[r];s&&s.patchValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((r,s)=>{r.reset(t?t[s]:null,{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,r)=>(t[r]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,r)=>r._syncPendingControls()?!0:e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{let r=this.controls[e];r&&t(r,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(let[e,r]of Object.entries(this.controls))if(this.contains(e)&&t(r))return!0;return!1}_reduceValue(){let t={};return this._reduceChildren(t,(e,r,s)=>((r.enabled||this.disabled)&&(e[s]=r.value),e))}_reduceChildren(t,e){let r=t;return this._forEachChild((s,n)=>{r=e(r,s,n)}),r}_allControlsDisabled(){for(let t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}};var er=class extends _e{};var je=new Y("",{providedIn:"root",factory:()=>At}),At="always";function _i(i,t){return[...t.path,i]}function _t(i,t,e=At){cr(i,t),t.valueAccessor.writeValue(i.value),(i.disabled||e==="always")&&t.valueAccessor.setDisabledState?.(i.disabled),nn(i,t),an(i,t),on(i,t),sn(i,t)}function Qr(i,t,e=!0){let r=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(r),t.valueAccessor.registerOnTouched(r)),yt(i,t),i&&(t._invokeOnDestroyCallbacks(),i._registerOnCollectionChange(()=>{}))}function vt(i,t){i.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function sn(i,t){if(t.valueAccessor.setDisabledState){let e=r=>{t.valueAccessor.setDisabledState(r)};i.registerOnDisabledChange(e),t._registerOnDestroy(()=>{i._unregisterOnDisabledChange(e)})}}function cr(i,t){let e=fi(i);t.validator!==null?i.setValidators(Kr(e,t.validator)):typeof e=="function"&&i.setValidators([e]);let r=pi(i);t.asyncValidator!==null?i.setAsyncValidators(Kr(r,t.asyncValidator)):typeof r=="function"&&i.setAsyncValidators([r]);let s=()=>i.updateValueAndValidity();vt(t._rawValidators,s),vt(t._rawAsyncValidators,s)}function yt(i,t){let e=!1;if(i!==null){if(t.validator!==null){let s=fi(i);if(Array.isArray(s)&&s.length>0){let n=s.filter(o=>o!==t.validator);n.length!==s.length&&(e=!0,i.setValidators(n))}}if(t.asyncValidator!==null){let s=pi(i);if(Array.isArray(s)&&s.length>0){let n=s.filter(o=>o!==t.asyncValidator);n.length!==s.length&&(e=!0,i.setAsyncValidators(n))}}}let r=()=>{};return vt(t._rawValidators,r),vt(t._rawAsyncValidators,r),e}function nn(i,t){t.valueAccessor.registerOnChange(e=>{i._pendingValue=e,i._pendingChange=!0,i._pendingDirty=!0,i.updateOn==="change"&&vi(i,t)})}function on(i,t){t.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,i.updateOn==="blur"&&i._pendingChange&&vi(i,t),i.updateOn!=="submit"&&i.markAsTouched()})}function vi(i,t){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function an(i,t){let e=(r,s)=>{t.valueAccessor.writeValue(r),s&&t.viewToModelUpdate(r)};i.registerOnChange(e),t._registerOnDestroy(()=>{i._unregisterOnChange(e)})}function yi(i,t){i==null,cr(i,t)}function ln(i,t){return yt(i,t)}function wi(i,t){if(!i.hasOwnProperty("model"))return!1;let e=i.model;return e.isFirstChange()?!0:!Object.is(t,e.currentValue)}function cn(i){return Object.getPrototypeOf(i.constructor)===Ns}function bi(i,t){i._syncPendingControls(),t.forEach(e=>{let r=e.control;r.updateOn==="submit"&&r._pendingChange&&(e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function Ci(i,t){if(!t)return null;Array.isArray(t);let e,r,s;return t.forEach(n=>{n.constructor===si?e=n:cn(n)?r=n:s=n}),s||r||e||null}function un(i,t){let e=i.indexOf(t);e>-1&&i.splice(e,1)}var hn={provide:q,useExisting:ue(()=>dn)},Ve=Promise.resolve(),dn=(()=>{class i extends q{callSetDisabledState;get submitted(){return B(this.submittedReactive)}_submitted=fe(()=>this.submittedReactive());submittedReactive=he(!1);_directives=new Set;form;ngSubmit=new X;options;constructor(e,r,s){super(),this.callSetDisabledState=s,this.form=new _e({},nr(e),or(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){Ve.then(()=>{let r=this._findContainer(e.path);e.control=r.registerControl(e.name,e.control),_t(e.control,e,this.callSetDisabledState),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){Ve.then(()=>{let r=this._findContainer(e.path);r&&r.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){Ve.then(()=>{let r=this._findContainer(e.path),s=new _e({});yi(s,e),r.registerControl(e.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){Ve.then(()=>{let r=this._findContainer(e.path);r&&r.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,r){Ve.then(()=>{this.form.get(e.path).setValue(r)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submittedReactive.set(!0),bi(this.form,this._directives),this.ngSubmit.emit(e),this.form._events.next(new gt(this.control)),e?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this.submittedReactive.set(!1),this.form._events.next(new mt(this.form))}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}static \u0275fac=function(r){return new(r||i)(w(wt,10),w(bt,10),w(je,8))};static \u0275dir=I({type:i,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(r,s){r&1&&ct("submit",function(o){return s.onSubmit(o)})("reset",function(){return s.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[de([hn]),L]})}return i})();function Zr(i,t){let e=i.indexOf(t);e>-1&&i.splice(e,1)}function ei(i){return typeof i=="object"&&i!==null&&Object.keys(i).length===2&&"value"in i&&"disabled"in i}var Me=class extends me{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(t=null,e,r){super(ar(e),lr(r,e)),this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Ct(e)&&(e.nonNullable||e.initialValueIsDefault)&&(ei(t)?this.defaultValue=t.value:this.defaultValue=t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&e.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,e.emitViewToModelChange!==!1)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){Zr(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){Zr(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(t){ei(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}};var fn=i=>i instanceof Me;var pn={provide:Q,useExisting:ue(()=>gn)},ti=Promise.resolve(),gn=(()=>{class i extends Q{_changeDetectorRef;callSetDisabledState;control=new Me;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new X;constructor(e,r,s,n,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this._parent=e,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=Ci(this,n)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){let r=e.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),wi(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){_t(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(e){ti.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){let r=e.isDisabled.currentValue,s=r!==0&&Gr(r);ti.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?_i(e,this._parent):[e]}static \u0275fac=function(r){return new(r||i)(w(q,9),w(wt,10),w(bt,10),w(rr,10),w(qr,8),w(je,8))};static \u0275dir=I({type:i,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[de([pn]),L,at]})}return i})();var No=(()=>{class i{static \u0275fac=function(r){return new(r||i)};static \u0275dir=I({type:i,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return i})();var Ai=new Y("");var mn={provide:q,useExisting:ue(()=>_n)},_n=(()=>{class i extends q{callSetDisabledState;get submitted(){return B(this._submittedReactive)}set submitted(e){this._submittedReactive.set(e)}_submitted=fe(()=>this._submittedReactive());_submittedReactive=he(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];form=null;ngSubmit=new X;constructor(e,r,s){super(),this.callSetDisabledState=s,this._setValidators(e),this._setAsyncValidators(r)}ngOnChanges(e){e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(yt(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){let r=this.form.get(e.path);return _t(r,e,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),r}getControl(e){return this.form.get(e.path)}removeControl(e){Qr(e.control||null,e,!1),un(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,r){this.form.get(e.path).setValue(r)}onSubmit(e){return this._submittedReactive.set(!0),bi(this.form,this.directives),this.ngSubmit.emit(e),this.form._events.next(new gt(this.control)),e?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this._submittedReactive.set(!1),this.form._events.next(new mt(this.form))}_updateDomValue(){this.directives.forEach(e=>{let r=e.control,s=this.form.get(e.path);r!==s&&(Qr(r||null,e),fn(s)&&(_t(s,e,this.callSetDisabledState),e.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){let r=this.form.get(e.path);yi(r,e),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){let r=this.form.get(e.path);r&&ln(r,e)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){cr(this.form,this),this._oldForm&&yt(this._oldForm,this)}static \u0275fac=function(r){return new(r||i)(w(wt,10),w(bt,10),w(je,8))};static \u0275dir=I({type:i,selectors:[["","formGroup",""]],hostBindings:function(r,s){r&1&&ct("submit",function(o){return s.onSubmit(o)})("reset",function(){return s.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[de([mn]),L,at]})}return i})();var vn={provide:Q,useExisting:ue(()=>yn)},yn=(()=>{class i extends Q{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(e){}model;update=new X;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(e,r,s,n,o){super(),this._ngModelWarningConfig=o,this._parent=e,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=Ci(this,n)}ngOnChanges(e){this._added||this._setUpControl(),wi(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return _i(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(r){return new(r||i)(w(q,13),w(wt,10),w(bt,10),w(rr,10),w(Ai,8))};static \u0275dir=I({type:i,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[de([vn]),L,at]})}return i})();var Ei=(()=>{class i{static \u0275fac=function(r){return new(r||i)};static \u0275mod=lt({type:i});static \u0275inj=ot({})}return i})(),tr=class extends me{constructor(t,e,r){super(ar(e),lr(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(t){return this.controls[this._adjustIndex(t)]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,r={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(t,e={}){let r=this._adjustIndex(t);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,r={}){let s=this._adjustIndex(t);s<0&&(s=0),this.controls[s]&&this.controls[s]._registerOnCollectionChange(()=>{}),this.controls.splice(s,1),e&&(this.controls.splice(s,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){mi(this,!1,t),t.forEach((r,s)=>{gi(this,!1,s),this.at(s).setValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t!=null&&(t.forEach((r,s)=>{this.at(s)&&this.at(s).patchValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((r,s)=>{r.reset(t[s],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_adjustIndex(t){return t<0?t+this.length:t}_syncPendingControls(){let t=this.controls.reduce((e,r)=>r._syncPendingControls()?!0:e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,r)=>{t(e,r)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(let t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}_find(t){return this.at(t)??null}};function ri(i){return!!i&&(i.asyncValidators!==void 0||i.validators!==void 0||i.updateOn!==void 0)}var Lo=(()=>{class i{useNonNullable=!1;get nonNullable(){let e=new i;return e.useNonNullable=!0,e}group(e,r=null){let s=this._reduceControls(e),n={};return ri(r)?n=r:r!==null&&(n.validators=r.validator,n.asyncValidators=r.asyncValidator),new _e(s,n)}record(e,r=null){let s=this._reduceControls(e);return new er(s,r)}control(e,r,s){let n={};return this.useNonNullable?(ri(r)?n=r:(n.validators=r,n.asyncValidators=s),new Me(e,V(x({},n),{nonNullable:!0}))):new Me(e,r,s)}array(e,r,s){let n=e.map(o=>this._createControl(o));return new tr(n,r,s)}_reduceControls(e){let r={};return Object.keys(e).forEach(s=>{r[s]=this._createControl(e[s])}),r}_createControl(e){if(e instanceof Me)return e;if(e instanceof me)return e;if(Array.isArray(e)){let r=e[0],s=e.length>1?e[1]:null,n=e.length>2?e[2]:null;return this.control(r,s,n)}else return this.control(e)}static \u0275fac=function(r){return new(r||i)};static \u0275prov=nt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var Bo=(()=>{class i{static withConfig(e){return{ngModule:i,providers:[{provide:je,useValue:e.callSetDisabledState??At}]}}static \u0275fac=function(r){return new(r||i)};static \u0275mod=lt({type:i});static \u0275inj=ot({imports:[Ei]})}return i})(),qo=(()=>{class i{static withConfig(e){return{ngModule:i,providers:[{provide:Ai,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:je,useValue:e.callSetDisabledState??At}]}}static \u0275fac=function(r){return new(r||i)};static \u0275mod=lt({type:i});static \u0275inj=ot({imports:[Ei]})}return i})();var Si=i=>{let t;return i?t=i:typeof fetch>"u"?t=(...e)=>import("./chunk-BX7VDEVO.js").then(({default:r})=>r(...e)):t=fetch,(...e)=>t(...e)};var Re=class extends Error{constructor(t,e="FunctionsError",r){super(t),this.name=e,this.context=r}},Et=class extends Re{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}},St=class extends Re{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}},xt=class extends Re{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}},ur=function(i){return i.Any="any",i.ApNortheast1="ap-northeast-1",i.ApNortheast2="ap-northeast-2",i.ApSouth1="ap-south-1",i.ApSoutheast1="ap-southeast-1",i.ApSoutheast2="ap-southeast-2",i.CaCentral1="ca-central-1",i.EuCentral1="eu-central-1",i.EuWest1="eu-west-1",i.EuWest2="eu-west-2",i.EuWest3="eu-west-3",i.SaEast1="sa-east-1",i.UsEast1="us-east-1",i.UsWest1="us-west-1",i.UsWest2="us-west-2",i}(ur||{});var wn=function(i,t,e,r){function s(n){return n instanceof e?n:new e(function(o){o(n)})}return new(e||(e=Promise))(function(n,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?n(u.value):s(u.value).then(a,l)}c((r=r.apply(i,t||[])).next())})},Fe=class{constructor(t,{headers:e={},customFetch:r,region:s=ur.Any}={}){this.url=t,this.headers=e,this.region=s,this.fetch=Si(r)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,e={}){var r;return wn(this,void 0,void 0,function*(){try{let{headers:s,method:n,body:o}=e,a={},{region:l}=e;l||(l=this.region),l&&l!=="any"&&(a["x-region"]=l);let c;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",c=o):typeof o=="string"?(a["Content-Type"]="text/plain",c=o):typeof FormData<"u"&&o instanceof FormData?c=o:(a["Content-Type"]="application/json",c=JSON.stringify(o)));let u=yield this.fetch(`${this.url}/${t}`,{method:n||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),s),body:c}).catch(y=>{throw new Et(y)}),d=u.headers.get("x-relay-error");if(d&&d==="true")throw new St(u);if(!u.ok)throw new xt(u);let p=((r=u.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),f;return p==="application/json"?f=yield u.json():p==="application/octet-stream"?f=yield u.blob():p==="text/event-stream"?f=u:p==="multipart/form-data"?f=yield u.formData():f=yield u.text(),{data:f,error:null}}catch(s){return{data:null,error:s}}})}};var Ui=Rs(Fi(),1),{PostgrestClient:$i,PostgrestQueryBuilder:ca,PostgrestFilterBuilder:ua,PostgrestTransformBuilder:ha,PostgrestBuilder:da,PostgrestError:In}=Ui.default;var Ni="2.11.2";var Li={"X-Client-Info":`realtime-js/${Ni}`},Bi="1.0.0",Tt=1e4,qi=1e3,ye=function(i){return i[i.connecting=0]="connecting",i[i.open=1]="open",i[i.closing=2]="closing",i[i.closed=3]="closed",i}(ye||{}),k=function(i){return i.closed="closed",i.errored="errored",i.joined="joined",i.joining="joining",i.leaving="leaving",i}(k||{}),D=function(i){return i.close="phx_close",i.error="phx_error",i.join="phx_join",i.reply="phx_reply",i.leave="phx_leave",i.access_token="access_token",i}(D||{}),Cr=function(i){return i.websocket="websocket",i}(Cr||{}),Z=function(i){return i.Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed",i}(Z||{});var Vt=class{constructor(){this.HEADER_LENGTH=1}decode(t,e){return t.constructor===ArrayBuffer?e(this._binaryDecode(t)):e(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){let e=new DataView(t),r=new TextDecoder;return this._decodeBroadcast(t,e,r)}_decodeBroadcast(t,e,r){let s=e.getUint8(1),n=e.getUint8(2),o=this.HEADER_LENGTH+2,a=r.decode(t.slice(o,o+s));o=o+s;let l=r.decode(t.slice(o,o+n));o=o+n;let c=JSON.parse(r.decode(t.slice(o,t.byteLength)));return{ref:null,topic:a,event:l,payload:c}}};var we=class{constructor(t,e){this.callback=t,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var b=function(i){return i.abstime="abstime",i.bool="bool",i.date="date",i.daterange="daterange",i.float4="float4",i.float8="float8",i.int2="int2",i.int4="int4",i.int4range="int4range",i.int8="int8",i.int8range="int8range",i.json="json",i.jsonb="jsonb",i.money="money",i.numeric="numeric",i.oid="oid",i.reltime="reltime",i.text="text",i.time="time",i.timestamp="timestamp",i.timestamptz="timestamptz",i.timetz="timetz",i.tsrange="tsrange",i.tstzrange="tstzrange",i}(b||{}),Er=(i,t,e={})=>{var r;let s=(r=e.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(t).reduce((n,o)=>(n[o]=Pn(o,i,t,s),n),{})},Pn=(i,t,e,r)=>{let s=t.find(a=>a.name===i),n=s?.type,o=e[i];return n&&!r.includes(n)?Gi(n,o):Ar(o)},Gi=(i,t)=>{if(i.charAt(0)==="_"){let e=i.slice(1,i.length);return Fn(t,e)}switch(i){case b.bool:return Mn(t);case b.float4:case b.float8:case b.int2:case b.int4:case b.int8:case b.numeric:case b.oid:return jn(t);case b.json:case b.jsonb:return Rn(t);case b.timestamp:return Un(t);case b.abstime:case b.date:case b.daterange:case b.int4range:case b.int8range:case b.money:case b.reltime:case b.text:case b.time:case b.timestamptz:case b.timetz:case b.tsrange:case b.tstzrange:return Ar(t);default:return Ar(t)}},Ar=i=>i,Mn=i=>{switch(i){case"t":return!0;case"f":return!1;default:return i}},jn=i=>{if(typeof i=="string"){let t=parseFloat(i);if(!Number.isNaN(t))return t}return i},Rn=i=>{if(typeof i=="string")try{return JSON.parse(i)}catch(t){return console.log(`JSON parse error: ${t}`),i}return i},Fn=(i,t)=>{if(typeof i!="string")return i;let e=i.length-1,r=i[e];if(i[0]==="{"&&r==="}"){let n,o=i.slice(1,e);try{n=JSON.parse("["+o+"]")}catch{n=o?o.split(","):[]}return n.map(a=>Gi(t,a))}return i},Un=i=>typeof i=="string"?i.replace(" ","T"):i,It=i=>{let t=i;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};var be=class{constructor(t,e,r={},s=Tt){this.channel=t,this.event=e,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,e){var r;return this._hasReceived(t)&&e((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:t,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);let t=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:e}){this.recHooks.filter(r=>r.status===t).forEach(r=>r.callback(e))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}};var Ge=class i{constructor(t,e){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let r=e?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{let{onJoin:n,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=i.syncState(this.state,s,n,o),this.pendingDiffs.forEach(l=>{this.state=i.syncDiff(this.state,l,n,o)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},s=>{let{onJoin:n,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=i.syncDiff(this.state,s,n,o),a())}),this.onJoin((s,n,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:n,newPresences:o})}),this.onLeave((s,n,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:n,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,e,r,s){let n=this.cloneDeep(t),o=this.transformState(e),a={},l={};return this.map(n,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{let d=n[c];if(d){let p=u.map(v=>v.presence_ref),f=d.map(v=>v.presence_ref),y=u.filter(v=>f.indexOf(v.presence_ref)<0),_=d.filter(v=>p.indexOf(v.presence_ref)<0);y.length>0&&(a[c]=y),_.length>0&&(l[c]=_)}else a[c]=u}),this.syncDiff(n,{joins:a,leaves:l},r,s)}static syncDiff(t,e,r,s){let{joins:n,leaves:o}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(n,(a,l)=>{var c;let u=(c=t[a])!==null&&c!==void 0?c:[];if(t[a]=this.cloneDeep(l),u.length>0){let d=t[a].map(f=>f.presence_ref),p=u.filter(f=>d.indexOf(f.presence_ref)<0);t[a].unshift(...p)}r(a,u,l)}),this.map(o,(a,l)=>{let c=t[a];if(!c)return;let u=l.map(d=>d.presence_ref);c=c.filter(d=>u.indexOf(d.presence_ref)<0),t[a]=c,s(a,c,l),c.length===0&&delete t[a]}),t}static map(t,e){return Object.getOwnPropertyNames(t).map(r=>e(r,t[r]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((e,r)=>{let s=t[r];return"metas"in s?e[r]=s.metas.map(n=>(n.presence_ref=n.phx_ref,delete n.phx_ref,delete n.phx_ref_prev,n)):e[r]=s,e},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}};var G=function(i){return i.SUBSCRIBED="SUBSCRIBED",i.TIMED_OUT="TIMED_OUT",i.CLOSED="CLOSED",i.CHANNEL_ERROR="CHANNEL_ERROR",i}(G||{});var He=class i{constructor(t,e={config:{}},r){this.topic=t,this.params=e,this.socket=r,this.bindings={},this.state=k.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},e.config),this.timeout=this.socket.timeout,this.joinPush=new be(this,D.join,this.params,this.timeout),this.rejoinTimer=new we(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=k.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=k.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=k.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=k.errored,this.rejoinTimer.scheduleTimeout())}),this._on(D.reply,{},(s,n)=>{this._trigger(this._replyEventName(n),s)}),this.presence=new Ge(this),this.broadcastEndpointURL=It(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,e=this.timeout){var r,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{let{config:{broadcast:n,presence:o,private:a}}=this.params;this._onError(u=>t?.(G.CHANNEL_ERROR,u)),this._onClose(()=>t?.(G.CLOSED));let l={},c={broadcast:n,presence:o,postgres_changes:(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(u=>u.filter))!==null&&s!==void 0?s:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",d=>h(this,[d],function*({postgres_changes:u}){var p;if(this.socket.setAuth(),u===void 0){t?.(G.SUBSCRIBED);return}else{let f=this.bindings.postgres_changes,y=(p=f?.length)!==null&&p!==void 0?p:0,_=[];for(let v=0;v<y;v++){let E=f[v],{filter:{event:F,schema:U,table:T,filter:$}}=E,ce=u&&u[v];if(ce&&ce.event===F&&ce.schema===U&&ce.table===T&&ce.filter===$)_.push(Object.assign(Object.assign({},E),{id:ce.id}));else{this.unsubscribe(),t?.(G.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=_,t&&t(G.SUBSCRIBED);return}})).receive("error",u=>{t?.(G.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{t?.(G.TIMED_OUT)})}return this}presenceState(){return this.presence.state}track(r){return h(this,arguments,function*(t,e={}){return yield this.send({type:"presence",event:"track",payload:t},e.timeout||this.timeout)})}untrack(){return h(this,arguments,function*(t={}){return yield this.send({type:"presence",event:"untrack"},t)})}on(t,e,r){return this._on(t,e,r)}send(r){return h(this,arguments,function*(t,e={}){var s,n;if(!this._canPush()&&t.type==="broadcast"){let{event:o,payload:a}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:a,private:this.private}]})};try{let u=yield this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=e.timeout)!==null&&s!==void 0?s:this.timeout);return yield(n=u.body)===null||n===void 0?void 0:n.cancel(),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var a,l,c;let u=this._push(t.type,t,e.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(a=this.params)===null||a===void 0?void 0:a.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&o("ok"),u.receive("ok",()=>o("ok")),u.receive("error",()=>o("error")),u.receive("timeout",()=>o("timed out"))})})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=k.leaving;let e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(D.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{let s=new be(this,D.leave,{},t);s.receive("ok",()=>{e(),r("ok")}).receive("timeout",()=>{e(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}_fetchWithTimeout(t,e,r){return h(this,null,function*(){let s=new AbortController,n=setTimeout(()=>s.abort(),r),o=yield this.socket.fetch(t,Object.assign(Object.assign({},e),{signal:s.signal}));return clearTimeout(n),o})}_push(t,e,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new be(this,t,e,r);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(t,e,r){return e}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,e,r){var s,n;let o=t.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=D;if(r&&[a,l,c,u].indexOf(o)>=0&&r!==this._joinRef())return;let p=this._onMessage(o,e,r);if(e&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(f=>{var y,_,v;return((y=f.filter)===null||y===void 0?void 0:y.event)==="*"||((v=(_=f.filter)===null||_===void 0?void 0:_.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===o}).map(f=>f.callback(p,r)):(n=this.bindings[o])===null||n===void 0||n.filter(f=>{var y,_,v,E,F,U;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){let T=f.id,$=(y=f.filter)===null||y===void 0?void 0:y.event;return T&&((_=e.ids)===null||_===void 0?void 0:_.includes(T))&&($==="*"||$?.toLocaleLowerCase()===((v=e.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{let T=(F=(E=f?.filter)===null||E===void 0?void 0:E.event)===null||F===void 0?void 0:F.toLocaleLowerCase();return T==="*"||T===((U=e?.event)===null||U===void 0?void 0:U.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof p=="object"&&"ids"in p){let y=p.data,{schema:_,table:v,commit_timestamp:E,type:F,errors:U}=y;p=Object.assign(Object.assign({},{schema:_,table:v,commit_timestamp:E,eventType:F,new:{},old:{},errors:U}),this._getPayloadRecords(y))}f.callback(p,r)})}_isClosed(){return this.state===k.closed}_isJoined(){return this.state===k.joined}_isJoining(){return this.state===k.joining}_isLeaving(){return this.state===k.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,e,r){let s=t.toLocaleLowerCase(),n={type:s,filter:e,callback:r};return this.bindings[s]?this.bindings[s].push(n):this.bindings[s]=[n],this}_off(t,e){let r=t.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(s=>{var n;return!(((n=s.type)===null||n===void 0?void 0:n.toLocaleLowerCase())===r&&i.isEqual(s.filter,e))}),this}static isEqual(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(let r in t)if(t[r]!==e[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(D.close,{},t)}_onError(t){this._on(D.error,{},e=>t(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=k.joining,this.joinPush.resend(t))}_getPayloadRecords(t){let e={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(e.new=Er(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(e.old=Er(t.columns,t.old_record)),e}};var Nn=()=>{},Ln=typeof WebSocket<"u",Bn=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`,We=class{constructor(t,e){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=Li,this.params={},this.timeout=Tt,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Nn,this.conn=null,this.sendBuffer=[],this.serializer=new Vt,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=n=>{let o;return n?o=n:typeof fetch>"u"?o=(...a)=>import("./chunk-BX7VDEVO.js").then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${t}/${Cr.websocket}`,this.httpEndpoint=It(t),e?.transport?this.transport=e.transport:this.transport=null,e?.params&&(this.params=e.params),e?.headers&&(this.headers=Object.assign(Object.assign({},this.headers),e.headers)),e?.timeout&&(this.timeout=e.timeout),e?.logger&&(this.logger=e.logger),e?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=e.heartbeatIntervalMs);let s=(r=e?.params)===null||r===void 0?void 0:r.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=e?.reconnectAfterMs?e.reconnectAfterMs:n=>[1e3,2e3,5e3,1e4][n-1]||1e4,this.encode=e?.encode?e.encode:(n,o)=>o(JSON.stringify(n)),this.decode=e?.decode?e.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new we(()=>h(this,null,function*(){this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(e?.fetch),e?.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=e?.worker||!1,this.workerUrl=e?.workerUrl}this.accessToken=e?.accessToken||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(Ln){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new Sr(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),import("./chunk-BBCAVWXX.js").then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Bi}))}disconnect(t,e){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,e??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}removeChannel(t){return h(this,null,function*(){let e=yield t.unsubscribe();return this.channels.length===0&&this.disconnect(),e})}removeAllChannels(){return h(this,null,function*(){let t=yield Promise.all(this.channels.map(e=>e.unsubscribe()));return this.disconnect(),t})}log(t,e,r){this.logger(t,e,r)}connectionState(){switch(this.conn&&this.conn.readyState){case ye.connecting:return Z.Connecting;case ye.open:return Z.Open;case ye.closing:return Z.Closing;default:return Z.Closed}}isConnected(){return this.connectionState()===Z.Open}channel(t,e={config:{}}){let r=new He(`realtime:${t}`,e,this);return this.channels.push(r),r}push(t){let{topic:e,event:r,payload:s,ref:n}=t,o=()=>{this.encode(t,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${e} ${r} (${n})`,s),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(t=null){return h(this,null,function*(){let e=t||this.accessToken&&(yield this.accessToken())||this.accessTokenValue;if(e){let r=null;try{r=JSON.parse(atob(e.split(".")[1]))}catch{}if(r&&r.exp&&!(Math.floor(Date.now()/1e3)-r.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`);this.accessTokenValue=e,this.channels.forEach(s=>{e&&s.updateJoinPayload({access_token:e}),s.joinedOnce&&s._isJoined()&&s._push(D.access_token,{access_token:e})})}})}sendHeartbeat(){return h(this,null,function*(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(qi,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}})}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let e=this.channels.find(r=>r.topic===t&&(r._isJoined()||r._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${t}"`),e.unsubscribe())}_remove(t){this.channels=this.channels.filter(e=>e._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,e=>{let{topic:r,event:s,payload:n,ref:o}=e;o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${n.status||""} ${r} ${s} ${o&&"("+o+")"||""}`,n),this.channels.filter(a=>a._isMember(r)).forEach(a=>a._trigger(s,n,o)),this.stateChangeCallbacks.message.forEach(a=>a(e))})}_onConnOpen(){return h(this,null,function*(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{e.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())})}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(e=>e(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(e=>e(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(D.error))}_appendParams(t,e){if(Object.keys(e).length===0)return t;let r=t.match(/\?/)?"&":"?",s=new URLSearchParams(e);return`${t}${r}${s}`}_workerObjectUrl(t){let e;if(t)e=t;else{let r=new Blob([Bn],{type:"application/javascript"});e=URL.createObjectURL(r)}return e}};var Sr=class{constructor(t,e,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=ye.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=r.close}};var Ce=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function C(i){return typeof i=="object"&&i!==null&&"__isStorageError"in i}var Pt=class extends Ce{constructor(t,e){super(t),this.name="StorageApiError",this.status=e}toJSON(){return{name:this.name,message:this.message,status:this.status}}},ee=class extends Ce{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}};var qn=function(i,t,e,r){function s(n){return n instanceof e?n:new e(function(o){o(n)})}return new(e||(e=Promise))(function(n,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?n(u.value):s(u.value).then(a,l)}c((r=r.apply(i,t||[])).next())})},jt=i=>{let t;return i?t=i:typeof fetch>"u"?t=(...e)=>import("./chunk-BX7VDEVO.js").then(({default:r})=>r(...e)):t=fetch,(...e)=>t(...e)},Hi=()=>qn(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield import("./chunk-BX7VDEVO.js")).Response:Response}),Mt=i=>{if(Array.isArray(i))return i.map(e=>Mt(e));if(typeof i=="function"||i!==Object(i))return i;let t={};return Object.entries(i).forEach(([e,r])=>{let s=e.replace(/([-_][a-z])/gi,n=>n.toUpperCase().replace(/[-_]/g,""));t[s]=Mt(r)}),t};var te=function(i,t,e,r){function s(n){return n instanceof e?n:new e(function(o){o(n)})}return new(e||(e=Promise))(function(n,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?n(u.value):s(u.value).then(a,l)}c((r=r.apply(i,t||[])).next())})},xr=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),Gn=(i,t,e)=>te(void 0,void 0,void 0,function*(){let r=yield Hi();i instanceof r&&!e?.noResolveJson?i.json().then(s=>{t(new Pt(xr(s),i.status||500))}).catch(s=>{t(new ee(xr(s),s))}):t(new ee(xr(i),i))}),Hn=(i,t,e,r)=>{let s={method:i,headers:t?.headers||{}};return i==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},t?.headers),r&&(s.body=JSON.stringify(r)),Object.assign(Object.assign({},s),e))};function ze(i,t,e,r,s,n){return te(this,void 0,void 0,function*(){return new Promise((o,a)=>{i(e,Hn(t,r,s,n)).then(l=>{if(!l.ok)throw l;return r?.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>Gn(l,a,r))})})}function Ae(i,t,e,r){return te(this,void 0,void 0,function*(){return ze(i,"GET",t,e,r)})}function M(i,t,e,r,s){return te(this,void 0,void 0,function*(){return ze(i,"POST",t,r,s,e)})}function Wi(i,t,e,r,s){return te(this,void 0,void 0,function*(){return ze(i,"PUT",t,r,s,e)})}function zi(i,t,e,r){return te(this,void 0,void 0,function*(){return ze(i,"HEAD",t,Object.assign(Object.assign({},e),{noResolveJson:!0}),r)})}function Rt(i,t,e,r,s){return te(this,void 0,void 0,function*(){return ze(i,"DELETE",t,r,s,e)})}var S=function(i,t,e,r){function s(n){return n instanceof e?n:new e(function(o){o(n)})}return new(e||(e=Promise))(function(n,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?n(u.value):s(u.value).then(a,l)}c((r=r.apply(i,t||[])).next())})},Wn={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ji={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1},Ft=class{constructor(t,e={},r,s){this.url=t,this.headers=e,this.bucketId=r,this.fetch=jt(s)}uploadOrUpdate(t,e,r,s){return S(this,void 0,void 0,function*(){try{let n,o=Object.assign(Object.assign({},Ji),s),a=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)}),l=o.metadata;typeof Blob<"u"&&r instanceof Blob?(n=new FormData,n.append("cacheControl",o.cacheControl),l&&n.append("metadata",this.encodeMetadata(l)),n.append("",r)):typeof FormData<"u"&&r instanceof FormData?(n=r,n.append("cacheControl",o.cacheControl),l&&n.append("metadata",this.encodeMetadata(l))):(n=r,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),s?.headers&&(a=Object.assign(Object.assign({},a),s.headers));let c=this._removeEmptyFolders(e),u=this._getFinalPath(c),d=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:t,body:n,headers:a},o?.duplex?{duplex:o.duplex}:{})),p=yield d.json();return d.ok?{data:{path:c,id:p.Id,fullPath:p.Key},error:null}:{data:null,error:p}}catch(n){if(C(n))return{data:null,error:n};throw n}})}upload(t,e,r){return S(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,e,r)})}uploadToSignedUrl(t,e,r,s){return S(this,void 0,void 0,function*(){let n=this._removeEmptyFolders(t),o=this._getFinalPath(n),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",e);try{let l,c=Object.assign({upsert:Ji.upsert},s),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);let d=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:u}),p=yield d.json();return d.ok?{data:{path:n,fullPath:p.Key},error:null}:{data:null,error:p}}catch(l){if(C(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,e){return S(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t),s=Object.assign({},this.headers);e?.upsert&&(s["x-upsert"]="true");let n=yield M(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),o=new URL(this.url+n.url),a=o.searchParams.get("token");if(!a)throw new Ce("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:a},error:null}}catch(r){if(C(r))return{data:null,error:r};throw r}})}update(t,e,r){return S(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,e,r)})}move(t,e,r){return S(this,void 0,void 0,function*(){try{return{data:yield M(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r?.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(C(s))return{data:null,error:s};throw s}})}copy(t,e,r){return S(this,void 0,void 0,function*(){try{return{data:{path:(yield M(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(C(s))return{data:null,error:s};throw s}})}createSignedUrl(t,e,r){return S(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),n=yield M(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:e},r?.transform?{transform:r.transform}:{}),{headers:this.headers}),o=r?.download?`&download=${r.download===!0?"":r.download}`:"";return n={signedUrl:encodeURI(`${this.url}${n.signedURL}${o}`)},{data:n,error:null}}catch(s){if(C(s))return{data:null,error:s};throw s}})}createSignedUrls(t,e,r){return S(this,void 0,void 0,function*(){try{let s=yield M(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:t},{headers:this.headers}),n=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${n}`):null})),error:null}}catch(s){if(C(s))return{data:null,error:s};throw s}})}download(t,e){return S(this,void 0,void 0,function*(){let s=typeof e?.transform<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString(e?.transform||{}),o=n?`?${n}`:"";try{let a=this._getFinalPath(t);return{data:yield(yield Ae(this.fetch,`${this.url}/${s}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(C(a))return{data:null,error:a};throw a}})}info(t){return S(this,void 0,void 0,function*(){let e=this._getFinalPath(t);try{let r=yield Ae(this.fetch,`${this.url}/object/info/${e}`,{headers:this.headers});return{data:Mt(r),error:null}}catch(r){if(C(r))return{data:null,error:r};throw r}})}exists(t){return S(this,void 0,void 0,function*(){let e=this._getFinalPath(t);try{return yield zi(this.fetch,`${this.url}/object/${e}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(C(r)&&r instanceof ee){let s=r.originalError;if([400,404].includes(s?.status))return{data:!1,error:r}}throw r}})}getPublicUrl(t,e){let r=this._getFinalPath(t),s=[],n=e?.download?`download=${e.download===!0?"":e.download}`:"";n!==""&&s.push(n);let a=typeof e?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(e?.transform||{});l!==""&&s.push(l);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${c}`)}}}remove(t){return S(this,void 0,void 0,function*(){try{return{data:yield Rt(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(e){if(C(e))return{data:null,error:e};throw e}})}list(t,e,r){return S(this,void 0,void 0,function*(){try{let s=Object.assign(Object.assign(Object.assign({},Wn),e),{prefix:t||""});return{data:yield M(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(C(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){let e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};var Ki="2.7.1";var Yi={"X-Client-Info":`storage-js/${Ki}`};var Ee=function(i,t,e,r){function s(n){return n instanceof e?n:new e(function(o){o(n)})}return new(e||(e=Promise))(function(n,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?n(u.value):s(u.value).then(a,l)}c((r=r.apply(i,t||[])).next())})},Ut=class{constructor(t,e={},r){this.url=t,this.headers=Object.assign(Object.assign({},Yi),e),this.fetch=jt(r)}listBuckets(){return Ee(this,void 0,void 0,function*(){try{return{data:yield Ae(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(C(t))return{data:null,error:t};throw t}})}getBucket(t){return Ee(this,void 0,void 0,function*(){try{return{data:yield Ae(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(e){if(C(e))return{data:null,error:e};throw e}})}createBucket(t,e={public:!1}){return Ee(this,void 0,void 0,function*(){try{return{data:yield M(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(C(r))return{data:null,error:r};throw r}})}updateBucket(t,e){return Ee(this,void 0,void 0,function*(){try{return{data:yield Wi(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(C(r))return{data:null,error:r};throw r}})}emptyBucket(t){return Ee(this,void 0,void 0,function*(){try{return{data:yield M(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(C(e))return{data:null,error:e};throw e}})}deleteBucket(t){return Ee(this,void 0,void 0,function*(){try{return{data:yield Rt(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(e){if(C(e))return{data:null,error:e};throw e}})}};var Je=class extends Ut{constructor(t,e={},r){super(t,e,r)}from(t){return new Ft(this.url,this.headers,t,this.fetch)}};var Xi="2.49.4";var Ke="";typeof Deno<"u"?Ke="deno":typeof document<"u"?Ke="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ke="react-native":Ke="node";var zn={"X-Client-Info":`supabase-js-${Ke}/${Xi}`},Qi={headers:zn},Zi={schema:"public"},es={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ts={};zr();var Jn=function(i,t,e,r){function s(n){return n instanceof e?n:new e(function(o){o(n)})}return new(e||(e=Promise))(function(n,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?n(u.value):s(u.value).then(a,l)}c((r=r.apply(i,t||[])).next())})},Kn=i=>{let t;return i?t=i:typeof fetch>"u"?t=Hr:t=fetch,(...e)=>t(...e)},Yn=()=>typeof Headers>"u"?Wr:Headers,rs=(i,t,e)=>{let r=Kn(e),s=Yn();return(n,o)=>Jn(void 0,void 0,void 0,function*(){var a;let l=(a=yield t())!==null&&a!==void 0?a:i,c=new s(o?.headers);return c.has("apikey")||c.set("apikey",i),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),r(n,Object.assign(Object.assign({},o),{headers:c}))})};var Xn=function(i,t,e,r){function s(n){return n instanceof e?n:new e(function(o){o(n)})}return new(e||(e=Promise))(function(n,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?n(u.value):s(u.value).then(a,l)}c((r=r.apply(i,t||[])).next())})};function is(i){return i.replace(/\/$/,"")}function ss(i,t){let{db:e,auth:r,realtime:s,global:n}=i,{db:o,auth:a,realtime:l,global:c}=t,u={db:Object.assign(Object.assign({},o),e),auth:Object.assign(Object.assign({},a),r),realtime:Object.assign(Object.assign({},l),s),global:Object.assign(Object.assign({},c),n),accessToken:()=>Xn(this,void 0,void 0,function*(){return""})};return i.accessToken?u.accessToken=i.accessToken:delete u.accessToken,u}var $t="2.69.1";var re=30*1e3,Nt=3,Lt=Nt*re,ns="http://localhost:9999",os="supabase.auth.token";var as={"X-Client-Info":`gotrue-js/${$t}`};var Ye="X-Supabase-Api-Version",kr={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},ls=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,cs=6e5;var Xe=class extends Error{constructor(t,e,r){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=e,this.code=r}};function g(i){return typeof i=="object"&&i!==null&&"__isAuthError"in i}var Bt=class extends Xe{constructor(t,e,r){super(t,e,r),this.name="AuthApiError",this.status=e,this.code=r}};function us(i){return g(i)&&i.name==="AuthApiError"}var Se=class extends Xe{constructor(t,e){super(t),this.name="AuthUnknownError",this.originalError=e}},j=class extends Xe{constructor(t,e,r,s){super(t,r,s),this.name=e,this.status=r}},O=class extends j{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}};function hs(i){return g(i)&&i.name==="AuthSessionMissingError"}var xe=class extends j{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}},ie=class extends j{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}},se=class extends j{constructor(t,e=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}};function ds(i){return g(i)&&i.name==="AuthImplicitGrantRedirectError"}var Qe=class extends j{constructor(t,e=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}},ke=class extends j{constructor(t,e){super(t,"AuthRetryableFetchError",e,void 0)}};function qt(i){return g(i)&&i.name==="AuthRetryableFetchError"}var Ze=class extends j{constructor(t,e,r){super(t,"AuthWeakPasswordError",e,"weak_password"),this.reasons=r}};var H=class extends j{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}};var fs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ps=` 	
\r=`.split(""),Qn=(()=>{let i=new Array(128);for(let t=0;t<i.length;t+=1)i[t]=-1;for(let t=0;t<ps.length;t+=1)i[ps[t].charCodeAt(0)]=-2;for(let t=0;t<fs.length;t+=1)i[fs[t].charCodeAt(0)]=t;return i})();function gs(i,t,e){let r=Qn[i];if(r>-1)for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)e(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(i)}"`)}}function Dr(i){let t=[],e=o=>{t.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},n=o=>{to(o,r,e)};for(let o=0;o<i.length;o+=1)gs(i.charCodeAt(o),s,n);return t.join("")}function Zn(i,t){if(i<=127){t(i);return}else if(i<=2047){t(192|i>>6),t(128|i&63);return}else if(i<=65535){t(224|i>>12),t(128|i>>6&63),t(128|i&63);return}else if(i<=1114111){t(240|i>>18),t(128|i>>12&63),t(128|i>>6&63),t(128|i&63);return}throw new Error(`Unrecognized Unicode codepoint: ${i.toString(16)}`)}function eo(i,t){for(let e=0;e<i.length;e+=1){let r=i.charCodeAt(e);if(r>55295&&r<=56319){let s=(r-55296)*1024&65535;r=(i.charCodeAt(e+1)-56320&65535|s)+65536,e+=1}Zn(r,t)}}function to(i,t,e){if(t.utf8seq===0){if(i<=127){e(i);return}for(let r=1;r<6;r+=1)if((i>>7-r&1)===0){t.utf8seq=r;break}if(t.utf8seq===2)t.codepoint=i&31;else if(t.utf8seq===3)t.codepoint=i&15;else if(t.utf8seq===4)t.codepoint=i&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(i<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|i&63,t.utf8seq-=1,t.utf8seq===0&&e(t.codepoint)}}function ms(i){let t=[],e={queue:0,queuedBits:0},r=s=>{t.push(s)};for(let s=0;s<i.length;s+=1)gs(i.charCodeAt(s),e,r);return new Uint8Array(t)}function _s(i){let t=[];return eo(i,e=>t.push(e)),new Uint8Array(t)}function vs(i){return Math.round(Date.now()/1e3)+i}function ys(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){let t=Math.random()*16|0;return(i=="x"?t:t&3|8).toString(16)})}var P=()=>typeof window<"u"&&typeof document<"u",ne={tested:!1,writable:!1},K=()=>{if(!P())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ne.tested)return ne.writable;let i=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(i,i),globalThis.localStorage.removeItem(i),ne.tested=!0,ne.writable=!0}catch{ne.tested=!0,ne.writable=!1}return ne.writable};function ws(i){let t={},e=new URL(i);if(e.hash&&e.hash[0]==="#")try{new URLSearchParams(e.hash.substring(1)).forEach((s,n)=>{t[n]=s})}catch{}return e.searchParams.forEach((r,s)=>{t[s]=r}),t}var Gt=i=>{let t;return i?t=i:typeof fetch>"u"?t=(...e)=>import("./chunk-BX7VDEVO.js").then(({default:r})=>r(...e)):t=fetch,(...e)=>t(...e)},bs=i=>typeof i=="object"&&i!==null&&"status"in i&&"ok"in i&&"json"in i&&typeof i.json=="function",Or=(i,t,e)=>h(void 0,null,function*(){yield i.setItem(t,JSON.stringify(e))}),tt=(i,t)=>h(void 0,null,function*(){let e=yield i.getItem(t);if(!e)return null;try{return JSON.parse(e)}catch{return e}}),rt=(i,t)=>h(void 0,null,function*(){yield i.removeItem(t)}),et=class i{constructor(){this.promise=new i.promiseConstructor((t,e)=>{this.resolve=t,this.reject=e})}};et.promiseConstructor=Promise;function Ht(i){let t=i.split(".");if(t.length!==3)throw new H("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!ls.test(t[r]))throw new H("JWT not in base64url format");return{header:JSON.parse(Dr(t[0])),payload:JSON.parse(Dr(t[1])),signature:ms(t[2]),raw:{header:t[0],payload:t[1]}}}function Cs(i){return h(this,null,function*(){return yield new Promise(t=>{setTimeout(()=>t(null),i)})})}function As(i,t){return new Promise((r,s)=>{h(this,null,function*(){for(let n=0;n<1/0;n++)try{let o=yield i(n);if(!t(n,null,o)){r(o);return}}catch(o){if(!t(n,o)){s(o);return}}})})}function ro(i){return("0"+i.toString(16)).substr(-2)}function io(){let t=new Uint32Array(56);if(typeof crypto>"u"){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=e.length,s="";for(let n=0;n<56;n++)s+=e.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(t),Array.from(t,ro).join("")}function so(i){return h(this,null,function*(){let e=new TextEncoder().encode(i),r=yield crypto.subtle.digest("SHA-256",e),s=new Uint8Array(r);return Array.from(s).map(n=>String.fromCharCode(n)).join("")})}function no(i){return h(this,null,function*(){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),i;let e=yield so(i);return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")})}function oe(i,t,e=!1){return h(this,null,function*(){let r=io(),s=r;e&&(s+="/PASSWORD_RECOVERY"),yield Or(i,`${t}-code-verifier`,s);let n=yield no(r);return[n,r===n?"plain":"s256"]})}var oo=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Es(i){let t=i.headers.get(Ye);if(!t||!t.match(oo))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Ss(i){if(!i)throw new Error("Missing exp claim");let t=Math.floor(Date.now()/1e3);if(i<=t)throw new Error("JWT has expired")}function xs(i){switch(i){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var ao=function(i,t){var e={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&t.indexOf(r)<0&&(e[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(i);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(i,r[s])&&(e[r[s]]=i[r[s]]);return e},ae=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),lo=[502,503,504];function ks(i){return h(this,null,function*(){var t;if(!bs(i))throw new ke(ae(i),0);if(lo.includes(i.status))throw new ke(ae(i),i.status);let e;try{e=yield i.json()}catch(n){throw new Se(ae(n),n)}let r,s=Es(i);if(s&&s.getTime()>=kr["2024-01-01"].timestamp&&typeof e=="object"&&e&&typeof e.code=="string"?r=e.code:typeof e=="object"&&e&&typeof e.error_code=="string"&&(r=e.error_code),r){if(r==="weak_password")throw new Ze(ae(e),i.status,((t=e.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(r==="session_not_found")throw new O}else if(typeof e=="object"&&e&&typeof e.weak_password=="object"&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((n,o)=>n&&typeof o=="string",!0))throw new Ze(ae(e),i.status,e.weak_password.reasons);throw new Bt(ae(e),i.status||500,r)})}var co=(i,t,e,r)=>{let s={method:i,headers:t?.headers||{}};return i==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),e))};function m(i,t,e,r){return h(this,null,function*(){var s;let n=Object.assign({},r?.headers);n[Ye]||(n[Ye]=kr["2024-01-01"].name),r?.jwt&&(n.Authorization=`Bearer ${r.jwt}`);let o=(s=r?.query)!==null&&s!==void 0?s:{};r?.redirectTo&&(o.redirect_to=r.redirectTo);let a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=yield uo(i,t,e+a,{headers:n,noResolveJson:r?.noResolveJson},{},r?.body);return r?.xform?r?.xform(l):{data:Object.assign({},l),error:null}})}function uo(i,t,e,r,s,n){return h(this,null,function*(){let o=co(t,r,s,n),a;try{a=yield i(e,Object.assign({},o))}catch(l){throw console.error(l),new ke(ae(l),0)}if(a.ok||(yield ks(a)),r?.noResolveJson)return a;try{return yield a.json()}catch(l){yield ks(l)}})}function W(i){var t;let e=null;ho(i)&&(e=Object.assign({},i),i.expires_at||(e.expires_at=vs(i.expires_in)));let r=(t=i.user)!==null&&t!==void 0?t:i;return{data:{session:e,user:r},error:null}}function Tr(i){let t=W(i);return!t.error&&i.weak_password&&typeof i.weak_password=="object"&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.message&&typeof i.weak_password.message=="string"&&i.weak_password.reasons.reduce((e,r)=>e&&typeof r=="string",!0)&&(t.data.weak_password=i.weak_password),t}function R(i){var t;return{data:{user:(t=i.user)!==null&&t!==void 0?t:i},error:null}}function Ds(i){return{data:i,error:null}}function Os(i){let{action_link:t,email_otp:e,hashed_token:r,redirect_to:s,verification_type:n}=i,o=ao(i,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:t,email_otp:e,hashed_token:r,redirect_to:s,verification_type:n},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function Ts(i){return i}function ho(i){return i.access_token&&i.refresh_token&&i.expires_in}var fo=function(i,t){var e={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&t.indexOf(r)<0&&(e[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(i);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(i,r[s])&&(e[r[s]]=i[r[s]]);return e},De=class{constructor({url:t="",headers:e={},fetch:r}){this.url=t,this.headers=e,this.fetch=Gt(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}signOut(t,e="global"){return h(this,null,function*(){try{return yield m(this.fetch,"POST",`${this.url}/logout?scope=${e}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(r){if(g(r))return{data:null,error:r};throw r}})}inviteUserByEmail(r){return h(this,arguments,function*(t,e={}){try{return yield m(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:R})}catch(s){if(g(s))return{data:{user:null},error:s};throw s}})}generateLink(t){return h(this,null,function*(){try{let{options:e}=t,r=fo(t,["options"]),s=Object.assign(Object.assign({},r),e);return"newEmail"in r&&(s.new_email=r?.newEmail,delete s.newEmail),yield m(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:Os,redirectTo:e?.redirectTo})}catch(e){if(g(e))return{data:{properties:null,user:null},error:e};throw e}})}createUser(t){return h(this,null,function*(){try{return yield m(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:R})}catch(e){if(g(e))return{data:{user:null},error:e};throw e}})}listUsers(t){return h(this,null,function*(){var e,r,s,n,o,a,l;try{let c={nextPage:null,lastPage:0,total:0},u=yield m(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(e=t?.page)===null||e===void 0?void 0:e.toString())!==null&&r!==void 0?r:"",per_page:(n=(s=t?.perPage)===null||s===void 0?void 0:s.toString())!==null&&n!==void 0?n:""},xform:Ts});if(u.error)throw u.error;let d=yield u.json(),p=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(y=>{let _=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(y.split(";")[1].split("=")[1]);c[`${v}Page`]=_}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(g(c))return{data:{users:[]},error:c};throw c}})}getUserById(t){return h(this,null,function*(){try{return yield m(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:R})}catch(e){if(g(e))return{data:{user:null},error:e};throw e}})}updateUserById(t,e){return h(this,null,function*(){try{return yield m(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:e,headers:this.headers,xform:R})}catch(r){if(g(r))return{data:{user:null},error:r};throw r}})}deleteUser(t,e=!1){return h(this,null,function*(){try{return yield m(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:e},xform:R})}catch(r){if(g(r))return{data:{user:null},error:r};throw r}})}_listFactors(t){return h(this,null,function*(){try{let{data:e,error:r}=yield m(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:e,error:r}}catch(e){if(g(e))return{data:null,error:e};throw e}})}_deleteFactor(t){return h(this,null,function*(){try{return{data:yield m(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(e){if(g(e))return{data:null,error:e};throw e}})}};var Vs={getItem:i=>K()?globalThis.localStorage.getItem(i):null,setItem:(i,t)=>{K()&&globalThis.localStorage.setItem(i,t)},removeItem:i=>{K()&&globalThis.localStorage.removeItem(i)}};function Vr(i={}){return{getItem:t=>i[t]||null,setItem:(t,e)=>{i[t]=e},removeItem:t=>{delete i[t]}}}function Is(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}var le={debug:!!(globalThis&&K()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")},it=class extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}},Wt=class extends it{};function Ir(i,t,e){return h(this,null,function*(){le.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",i,t);let r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),le.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",i)},t),yield Promise.resolve().then(()=>globalThis.navigator.locks.request(i,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},s=>h(this,null,function*(){if(s){le.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",i,s.name);try{return yield e()}finally{le.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",i,s.name)}}else{if(t===0)throw le.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",i),new Wt(`Acquiring an exclusive Navigator LockManager lock "${i}" immediately failed`);if(le.debug)try{let n=yield globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(n,null,"  "))}catch(n){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",n)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),yield e()}})))})}Is();var po={url:ns,storageKey:os,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:as,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};function Ps(i,t,e){return h(this,null,function*(){return yield e()})}var Pr=(()=>{class i{constructor(e){var r,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=i.nextInstanceID,i.nextInstanceID+=1,this.instanceID>0&&P()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");let n=Object.assign(Object.assign({},po),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new De({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=Gt(n.fetch),this.lock=n.lock||Ps,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:P()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=Ir:this.lock=Ps,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:K()?this.storage=Vs:(this.memoryStorage={},this.storage=Vr(this.memoryStorage)):(this.memoryStorage={},this.storage=Vr(this.memoryStorage)),P()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",o=>h(this,null,function*(){this._debug("received broadcast notification from other tab or client",o),yield this._notifyAllSubscribers(o.data.event,o.data.session,!1)}))}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${$t}) ${new Date().toISOString()}`,...e),this}initialize(){return h(this,null,function*(){return this.initializePromise?yield this.initializePromise:(this.initializePromise=h(this,null,function*(){return yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._initialize()}))}),yield this.initializePromise)})}_initialize(){return h(this,null,function*(){var e;try{let r=ws(window.location.href),s="none";if(this._isImplicitGrantCallback(r)?s="implicit":(yield this._isPKCECallback(r))&&(s="pkce"),P()&&this.detectSessionInUrl&&s!=="none"){let{data:n,error:o}=yield this._getSessionFromURL(r,s);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),ds(o)){let c=(e=o.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:o}}return yield this._removeSession(),{error:o}}let{session:a,redirectType:l}=n;return this._debug("#_initialize()","detected session in URL",a,"redirect type",l),yield this._saveSession(a),setTimeout(()=>h(this,null,function*(){l==="recovery"?yield this._notifyAllSubscribers("PASSWORD_RECOVERY",a):yield this._notifyAllSubscribers("SIGNED_IN",a)}),0),{error:null}}return yield this._recoverAndRefresh(),{error:null}}catch(r){return g(r)?{error:r}:{error:new Se("Unexpected error during initialization",r)}}finally{yield this._handleVisibilityChange(),this._debug("#_initialize()","end")}})}signInAnonymously(e){return h(this,null,function*(){var r,s,n;try{let o=yield m(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e?.options)===null||n===void 0?void 0:n.captchaToken}},xform:W}),{data:a,error:l}=o;if(l||!a)return{data:{user:null,session:null},error:l};let c=a.session,u=a.user;return a.session&&(yield this._saveSession(a.session),yield this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(o){if(g(o))return{data:{user:null,session:null},error:o};throw o}})}signUp(e){return h(this,null,function*(){var r,s,n;try{let o;if("email"in e){let{email:d,password:p,options:f}=e,y=null,_=null;this.flowType==="pkce"&&([y,_]=yield oe(this.storage,this.storageKey)),o=yield m(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f?.emailRedirectTo,body:{email:d,password:p,data:(r=f?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:y,code_challenge_method:_},xform:W})}else if("phone"in e){let{phone:d,password:p,options:f}=e;o=yield m(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:p,data:(s=f?.data)!==null&&s!==void 0?s:{},channel:(n=f?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:W})}else throw new ie("You must provide either an email or phone number and a password");let{data:a,error:l}=o;if(l||!a)return{data:{user:null,session:null},error:l};let c=a.session,u=a.user;return a.session&&(yield this._saveSession(a.session),yield this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(o){if(g(o))return{data:{user:null,session:null},error:o};throw o}})}signInWithPassword(e){return h(this,null,function*(){try{let r;if("email"in e){let{email:o,password:a,options:l}=e;r=yield m(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:a,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Tr})}else if("phone"in e){let{phone:o,password:a,options:l}=e;r=yield m(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:a,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Tr})}else throw new ie("You must provide either an email or phone number and a password");let{data:s,error:n}=r;return n?{data:{user:null,session:null},error:n}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new xe}:(s.session&&(yield this._saveSession(s.session),yield this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(r){if(g(r))return{data:{user:null,session:null},error:r};throw r}})}signInWithOAuth(e){return h(this,null,function*(){var r,s,n,o;return yield this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})})}exchangeCodeForSession(e){return h(this,null,function*(){return yield this.initializePromise,this._acquireLock(-1,()=>h(this,null,function*(){return this._exchangeCodeForSession(e)}))})}_exchangeCodeForSession(e){return h(this,null,function*(){let r=yield tt(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(r??"").split("/");try{let{data:o,error:a}=yield m(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:W});if(yield rt(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new xe}:(o.session&&(yield this._saveSession(o.session),yield this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:n??null}),error:a})}catch(o){if(g(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}})}signInWithIdToken(e){return h(this,null,function*(){try{let{options:r,provider:s,token:n,access_token:o,nonce:a}=e,l=yield m(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:o,nonce:a,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:W}),{data:c,error:u}=l;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new xe}:(c.session&&(yield this._saveSession(c.session),yield this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(r){if(g(r))return{data:{user:null,session:null},error:r};throw r}})}signInWithOtp(e){return h(this,null,function*(){var r,s,n,o,a;try{if("email"in e){let{email:l,options:c}=e,u=null,d=null;this.flowType==="pkce"&&([u,d]=yield oe(this.storage,this.storageKey));let{error:p}=yield m(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c?.data)!==null&&r!==void 0?r:{},create_user:(s=c?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c?.emailRedirectTo});return{data:{user:null,session:null},error:p}}if("phone"in e){let{phone:l,options:c}=e,{data:u,error:d}=yield m(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(n=c?.data)!==null&&n!==void 0?n:{},create_user:(o=c?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(a=c?.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:u?.message_id},error:d}}throw new ie("You must provide either an email or phone number.")}catch(l){if(g(l))return{data:{user:null,session:null},error:l};throw l}})}verifyOtp(e){return h(this,null,function*(){var r,s;try{let n,o;"options"in e&&(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo,o=(s=e.options)===null||s===void 0?void 0:s.captchaToken);let{data:a,error:l}=yield m(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:n,xform:W});if(l)throw l;if(!a)throw new Error("An error occurred on token verification.");let c=a.session,u=a.user;return c?.access_token&&(yield this._saveSession(c),yield this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(n){if(g(n))return{data:{user:null,session:null},error:n};throw n}})}signInWithSSO(e){return h(this,null,function*(){var r,s,n;try{let o=null,a=null;return this.flowType==="pkce"&&([o,a]=yield oe(this.storage,this.storageKey)),yield m(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:a}),headers:this.headers,xform:Ds})}catch(o){if(g(o))return{data:null,error:o};throw o}})}reauthenticate(){return h(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._reauthenticate()}))})}_reauthenticate(){return h(this,null,function*(){try{return yield this._useSession(e=>h(this,null,function*(){let{data:{session:r},error:s}=e;if(s)throw s;if(!r)throw new O;let{error:n}=yield m(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:n}}))}catch(e){if(g(e))return{data:{user:null,session:null},error:e};throw e}})}resend(e){return h(this,null,function*(){try{let r=`${this.url}/resend`;if("email"in e){let{email:s,type:n,options:o}=e,{error:a}=yield m(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:o?.captchaToken}},redirectTo:o?.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){let{phone:s,type:n,options:o}=e,{data:a,error:l}=yield m(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:o?.captchaToken}}});return{data:{user:null,session:null,messageId:a?.message_id},error:l}}throw new ie("You must provide either an email or phone number and a type")}catch(r){if(g(r))return{data:{user:null,session:null},error:r};throw r}})}getSession(){return h(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return this._useSession(r=>h(this,null,function*(){return r}))}))})}_acquireLock(e,r){return h(this,null,function*(){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=h(this,null,function*(){return yield s,yield r()});return this.pendingInLock.push(h(this,null,function*(){try{yield n}catch{}})),n}return yield this.lock(`lock:${this.storageKey}`,e,()=>h(this,null,function*(){this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let s=r();for(this.pendingInLock.push(h(this,null,function*(){try{yield s}catch{}})),yield s;this.pendingInLock.length;){let n=[...this.pendingInLock];yield Promise.all(n),this.pendingInLock.splice(0,n.length)}return yield s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}})}_useSession(e){return h(this,null,function*(){this._debug("#_useSession","begin");try{let r=yield this.__loadSession();return yield e(r)}finally{this._debug("#_useSession","end")}})}__loadSession(){return h(this,null,function*(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null,r=yield tt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),yield this._removeSession())),!e)return{data:{session:null},error:null};let s=e.expires_at?e.expires_at*1e3-Date.now()<Lt:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,u,d)=>(!a&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,d))})}return{data:{session:e},error:null}}let{session:n,error:o}=yield this._callRefreshToken(e.refresh_token);return o?{data:{session:null},error:o}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}})}getUser(e){return h(this,null,function*(){return e?yield this._getUser(e):(yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._getUser()})))})}_getUser(e){return h(this,null,function*(){try{return e?yield m(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:R}):yield this._useSession(r=>h(this,null,function*(){var s,n,o;let{data:a,error:l}=r;if(l)throw l;return!(!((s=a.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new O}:yield m(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&o!==void 0?o:void 0,xform:R})}))}catch(r){if(g(r))return hs(r)&&(yield this._removeSession(),yield rt(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}})}updateUser(s){return h(this,arguments,function*(e,r={}){return yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._updateUser(e,r)}))})}_updateUser(s){return h(this,arguments,function*(e,r={}){try{return yield this._useSession(n=>h(this,null,function*(){let{data:o,error:a}=n;if(a)throw a;if(!o.session)throw new O;let l=o.session,c=null,u=null;this.flowType==="pkce"&&e.email!=null&&([c,u]=yield oe(this.storage,this.storageKey));let{data:d,error:p}=yield m(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:u}),jwt:l.access_token,xform:R});if(p)throw p;return l.user=d.user,yield this._saveSession(l),yield this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}}))}catch(n){if(g(n))return{data:{user:null},error:n};throw n}})}setSession(e){return h(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._setSession(e)}))})}_setSession(e){return h(this,null,function*(){try{if(!e.access_token||!e.refresh_token)throw new O;let r=Date.now()/1e3,s=r,n=!0,o=null,{payload:a}=Ht(e.access_token);if(a.exp&&(s=a.exp,n=s<=r),n){let{session:l,error:c}=yield this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};o=l}else{let{data:l,error:c}=yield this._getUser(e.access_token);if(c)throw c;o={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:s-r,expires_at:s},yield this._saveSession(o),yield this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(r){if(g(r))return{data:{session:null,user:null},error:r};throw r}})}refreshSession(e){return h(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._refreshSession(e)}))})}_refreshSession(e){return h(this,null,function*(){try{return yield this._useSession(r=>h(this,null,function*(){var s;if(!e){let{data:a,error:l}=r;if(l)throw l;e=(s=a.session)!==null&&s!==void 0?s:void 0}if(!e?.refresh_token)throw new O;let{session:n,error:o}=yield this._callRefreshToken(e.refresh_token);return o?{data:{user:null,session:null},error:o}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}}))}catch(r){if(g(r))return{data:{user:null,session:null},error:r};throw r}})}_getSessionFromURL(e,r){return h(this,null,function*(){try{if(!P())throw new se("No browser detected.");if(e.error||e.error_description||e.error_code)throw new se(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Qe("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new se("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Qe("No code detected.");let{data:U,error:T}=yield this._exchangeCodeForSession(e.code);if(T)throw T;let $=new URL(window.location.href);return $.searchParams.delete("code"),window.history.replaceState(window.history.state,"",$.toString()),{data:{session:U.session,redirectType:null},error:null}}let{provider_token:s,provider_refresh_token:n,access_token:o,refresh_token:a,expires_in:l,expires_at:c,token_type:u}=e;if(!o||!l||!a||!u)throw new se("No session defined in URL");let d=Math.round(Date.now()/1e3),p=parseInt(l),f=d+p;c&&(f=parseInt(c));let y=f-d;y*1e3<=re&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${y}s, should have been closer to ${p}s`);let _=f-p;d-_>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",_,f,d):d-_<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",_,f,d);let{data:v,error:E}=yield this._getUser(o);if(E)throw E;let F={provider_token:s,provider_refresh_token:n,access_token:o,expires_in:p,expires_at:f,refresh_token:a,token_type:u,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:F,redirectType:e.type},error:null}}catch(s){if(g(s))return{data:{session:null,redirectType:null},error:s};throw s}})}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}_isPKCECallback(e){return h(this,null,function*(){let r=yield tt(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)})}signOut(){return h(this,arguments,function*(e={scope:"global"}){return yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._signOut(e)}))})}_signOut(){return h(this,arguments,function*({scope:e}={scope:"global"}){return yield this._useSession(r=>h(this,null,function*(){var s;let{data:n,error:o}=r;if(o)return{error:o};let a=(s=n.session)===null||s===void 0?void 0:s.access_token;if(a){let{error:l}=yield this.admin.signOut(a,e);if(l&&!(us(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(yield this._removeSession(),yield rt(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))})}onAuthStateChange(e){let r=ys(),s={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),h(this,null,function*(){yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){this._emitInitialSession(r)}))}),{data:{subscription:s}}}_emitInitialSession(e){return h(this,null,function*(){return yield this._useSession(r=>h(this,null,function*(){var s,n;try{let{data:{session:o},error:a}=r;if(a)throw a;yield(s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",o),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){yield(n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}}))})}resetPasswordForEmail(s){return h(this,arguments,function*(e,r={}){let n=null,o=null;this.flowType==="pkce"&&([n,o]=yield oe(this.storage,this.storageKey,!0));try{return yield m(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:o,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(g(a))return{data:null,error:a};throw a}})}getUserIdentities(){return h(this,null,function*(){var e;try{let{data:r,error:s}=yield this.getUser();if(s)throw s;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(g(r))return{data:null,error:r};throw r}})}linkIdentity(e){return h(this,null,function*(){var r;try{let{data:s,error:n}=yield this._useSession(o=>h(this,null,function*(){var a,l,c,u,d;let{data:p,error:f}=o;if(f)throw f;let y=yield this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return yield m(this.fetch,"GET",y,{headers:this.headers,jwt:(d=(u=p.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})}));if(n)throw n;return P()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s?.url),{data:{provider:e.provider,url:s?.url},error:null}}catch(s){if(g(s))return{data:{provider:e.provider,url:null},error:s};throw s}})}unlinkIdentity(e){return h(this,null,function*(){try{return yield this._useSession(r=>h(this,null,function*(){var s,n;let{data:o,error:a}=r;if(a)throw a;return yield m(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})}))}catch(r){if(g(r))return{data:null,error:r};throw r}})}_refreshAccessToken(e){return h(this,null,function*(){let r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{let s=Date.now();return yield As(n=>h(this,null,function*(){return n>0&&(yield Cs(200*Math.pow(2,n-1))),this._debug(r,"refreshing attempt",n),yield m(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:W})}),(n,o)=>{let a=200*Math.pow(2,n);return o&&qt(o)&&Date.now()+a-s<re})}catch(s){if(this._debug(r,"error",s),g(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(r,"end")}})}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}_handleProviderSignIn(e,r){return h(this,null,function*(){let s=yield this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",s),P()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}})}_recoverAndRefresh(){return h(this,null,function*(){var e;let r="#_recoverAndRefresh()";this._debug(r,"begin");try{let s=yield tt(this.storage,this.storageKey);if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&(yield this._removeSession());return}let n=((e=s.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<Lt;if(this._debug(r,`session has${n?"":" not"} expired with margin of ${Lt}s`),n){if(this.autoRefreshToken&&s.refresh_token){let{error:o}=yield this._callRefreshToken(s.refresh_token);o&&(console.error(o),qt(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),yield this._removeSession()))}}else yield this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}})}_callRefreshToken(e){return h(this,null,function*(){var r,s;if(!e)throw new O;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new et;let{data:o,error:a}=yield this._refreshAccessToken(e);if(a)throw a;if(!o.session)throw new O;yield this._saveSession(o.session),yield this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);let l={session:o.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(o){if(this._debug(n,"error",o),g(o)){let a={session:null,error:o};return qt(o)||(yield this._removeSession()),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(o),o}finally{this.refreshingDeferred=null,this._debug(n,"end")}})}_notifyAllSubscribers(e,r,s=!0){return h(this,null,function*(){let n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:r});let o=[],a=Array.from(this.stateChangeEmitters.values()).map(l=>h(this,null,function*(){try{yield l.callback(e,r)}catch(c){o.push(c)}}));if(yield Promise.all(a),o.length>0){for(let l=0;l<o.length;l+=1)console.error(o[l]);throw o[0]}}finally{this._debug(n,"end")}})}_saveSession(e){return h(this,null,function*(){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,yield Or(this.storage,this.storageKey,e)})}_removeSession(){return h(this,null,function*(){this._debug("#_removeSession()"),yield rt(this.storage,this.storageKey),yield this._notifyAllSubscribers("SIGNED_OUT",null)})}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&P()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}_startAutoRefresh(){return h(this,null,function*(){yield this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),re);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(()=>h(this,null,function*(){yield this.initializePromise,yield this._autoRefreshTokenTick()}),0)})}_stopAutoRefresh(){return h(this,null,function*(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)})}startAutoRefresh(){return h(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._startAutoRefresh()})}stopAutoRefresh(){return h(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._stopAutoRefresh()})}_autoRefreshTokenTick(){return h(this,null,function*(){this._debug("#_autoRefreshTokenTick()","begin");try{yield this._acquireLock(0,()=>h(this,null,function*(){try{let e=Date.now();try{return yield this._useSession(r=>h(this,null,function*(){let{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}let n=Math.floor((s.expires_at*1e3-e)/re);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${re}ms, refresh threshold is ${Nt} ticks`),n<=Nt&&(yield this._callRefreshToken(s.refresh_token))}))}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(e){if(e.isAcquireTimeout||e instanceof it)this._debug("auto refresh token tick lock not available");else throw e}})}_handleVisibilityChange(){return h(this,null,function*(){if(this._debug("#_handleVisibilityChange()"),!P()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=()=>h(this,null,function*(){return yield this._onVisibilityChanged(!1)}),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),yield this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}})}_onVisibilityChanged(e){return h(this,null,function*(){let r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}yield this._recoverAndRefresh()})))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()})}_getUrlForProvider(e,r,s){return h(this,null,function*(){let n=[`provider=${encodeURIComponent(r)}`];if(s?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){let[o,a]=yield oe(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(a)}`});n.push(l.toString())}if(s?.queryParams){let o=new URLSearchParams(s.queryParams);n.push(o.toString())}return s?.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`})}_unenroll(e){return h(this,null,function*(){try{return yield this._useSession(r=>h(this,null,function*(){var s;let{data:n,error:o}=r;return o?{data:null,error:o}:yield m(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})}))}catch(r){if(g(r))return{data:null,error:r};throw r}})}_enroll(e){return h(this,null,function*(){try{return yield this._useSession(r=>h(this,null,function*(){var s,n;let{data:o,error:a}=r;if(a)return{data:null,error:a};let l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:u}=yield m(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=o?.session)===null||s===void 0?void 0:s.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((n=c?.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})}))}catch(r){if(g(r))return{data:null,error:r};throw r}})}_verify(e){return h(this,null,function*(){return this._acquireLock(-1,()=>h(this,null,function*(){try{return yield this._useSession(r=>h(this,null,function*(){var s;let{data:n,error:o}=r;if(o)return{data:null,error:o};let{data:a,error:l}=yield m(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token});return l?{data:null,error:l}:(yield this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),yield this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:l})}))}catch(r){if(g(r))return{data:null,error:r};throw r}}))})}_challenge(e){return h(this,null,function*(){return this._acquireLock(-1,()=>h(this,null,function*(){try{return yield this._useSession(r=>h(this,null,function*(){var s;let{data:n,error:o}=r;return o?{data:null,error:o}:yield m(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})}))}catch(r){if(g(r))return{data:null,error:r};throw r}}))})}_challengeAndVerify(e){return h(this,null,function*(){let{data:r,error:s}=yield this._challenge({factorId:e.factorId});return s?{data:null,error:s}:yield this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})})}_listFactors(){return h(this,null,function*(){let{data:{user:e},error:r}=yield this.getUser();if(r)return{data:null,error:r};let s=e?.factors||[],n=s.filter(a=>a.factor_type==="totp"&&a.status==="verified"),o=s.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:s,totp:n,phone:o},error:null}})}_getAuthenticatorAssuranceLevel(){return h(this,null,function*(){return this._acquireLock(-1,()=>h(this,null,function*(){return yield this._useSession(e=>h(this,null,function*(){var r,s;let{data:{session:n},error:o}=e;if(o)return{data:null,error:o};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let{payload:a}=Ht(n.access_token),l=null;a.aal&&(l=a.aal);let c=l;((s=(r=n.user.factors)===null||r===void 0?void 0:r.filter(p=>p.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(c="aal2");let d=a.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:d},error:null}}))}))})}fetchJwk(s){return h(this,arguments,function*(e,r={keys:[]}){let n=r.keys.find(l=>l.kid===e);if(n||(n=this.jwks.keys.find(l=>l.kid===e),n&&this.jwks_cached_at+cs>Date.now()))return n;let{data:o,error:a}=yield m(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;if(!o.keys||o.keys.length===0)throw new H("JWKS is empty");if(this.jwks=o,this.jwks_cached_at=Date.now(),n=o.keys.find(l=>l.kid===e),!n)throw new H("No matching signing key found in JWKS");return n})}getClaims(s){return h(this,arguments,function*(e,r={keys:[]}){try{let n=e;if(!n){let{data:_,error:v}=yield this.getSession();if(v||!_.session)return{data:null,error:v};n=_.session.access_token}let{header:o,payload:a,signature:l,raw:{header:c,payload:u}}=Ht(n);if(Ss(a.exp),!o.kid||o.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){let{error:_}=yield this.getUser(n);if(_)throw _;return{data:{claims:a,header:o,signature:l},error:null}}let d=xs(o.alg),p=yield this.fetchJwk(o.kid,r),f=yield crypto.subtle.importKey("jwk",p,d,!0,["verify"]);if(!(yield crypto.subtle.verify(d,f,l,_s(`${c}.${u}`))))throw new H("Invalid JWT signature");return{data:{claims:a,header:o,signature:l},error:null}}catch(n){if(g(n))return{data:null,error:n};throw n}})}}return i.nextInstanceID=0,i})();var go=Pr,Mr=go;var zt=class extends Mr{constructor(t){super(t)}};var mo=function(i,t,e,r){function s(n){return n instanceof e?n:new e(function(o){o(n)})}return new(e||(e=Promise))(function(n,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?n(u.value):s(u.value).then(a,l)}c((r=r.apply(i,t||[])).next())})},Jt=class{constructor(t,e,r){var s,n,o;if(this.supabaseUrl=t,this.supabaseKey=e,!t)throw new Error("supabaseUrl is required.");if(!e)throw new Error("supabaseKey is required.");let a=is(t);this.realtimeUrl=`${a}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,this.functionsUrl=`${a}/functions/v1`;let l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:Zi,realtime:ts,auth:Object.assign(Object.assign({},es),{storageKey:l}),global:Qi},u=ss(r??{},c);this.storageKey=(s=u.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(n=u.global.headers)!==null&&n!==void 0?n:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(d,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=u.auth)!==null&&o!==void 0?o:{},this.headers,u.global.fetch),this.fetch=rs(e,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new $i(`${a}/rest/v1`,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),u.accessToken||this._listenForAuthEvents()}get functions(){return new Fe(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Je(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},r={}){return this.rest.rpc(t,e,r)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,e;return mo(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();let{data:r}=yield this.auth.getSession();return(e=(t=r.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:s,storageKey:n,flowType:o,lock:a,debug:l},c,u){let d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new zt({url:this.authUrl,headers:Object.assign(Object.assign({},d),c),storageKey:n,autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:s,flowType:o,lock:a,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new We(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,r)=>{this._handleTokenChanged(e,"CLIENT",r?.access_token)})}_handleTokenChanged(t,e,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};var Ms=(i,t,e)=>new Jt(i,t,e);var jr={production:!1,apiUrl:"https://snfrvruyinrfmkydcork.supabase.co",publicAnonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNuZnJ2cnV5aW5yZm1reWRjb3JrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDYxNTYzOTAsImV4cCI6MjA2MTczMjM5MH0.9Ijgct2E_LVmdcchFopL8Ouzq85UNEB9iM6aaQmWN-c"};var z=Ms(jr.apiUrl,jr.publicAnonKey,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}});var js=class i{userDataSubject=new Fr(null);userData$=this.userDataSubject.asObservable();constructor(){z.auth.getUser().then(t=>{t.data?.user?this.loadUserData():this.userDataSubject.next(null)})}tempUserData=null;registerUser(t,e,r,s,n){return h(this,null,function*(){let{data:o,error:a}=yield z.auth.signUp({email:r,password:s});return o.user?.identities?.length===0?{success:!1,error:"Este correo ya est\xE1 registrado. Por favor, usa otro."}:a||!o.user?{success:!1,error:a?.message||"No se pudo registrar el usuario."}:(this.tempUserData={name:t,age:e,avatarFile:n},{success:!0})})}getCurrentUser(){return this.userDataSubject.getValue()}loadPromise=null;loadUserData(){return h(this,null,function*(){return this.loadPromise=h(this,null,function*(){let{data:t,error:e}=yield z.auth.getUser();if(e||!t.user){this.userDataSubject.next(null);return}let r=t.user.id;try{let{data:s,error:n}=yield z.from("Usuarios").select("*").eq("authId",r).single();if(n||!s)if(console.log("Usuario no encontrado en la tabla. Insertando datos..."),this.tempUserData){let{avatarFile:o,name:a,age:l}=this.tempUserData,c="";if(o){c=`avatarUsuarios/${`${r}_${Date.now()}_${o.name}`}`;let{error:f}=yield z.storage.from("imagenes").upload(c,o,{cacheControl:"3600",upsert:!1});if(f){console.error("Error al subir avatar:",f.message),this.userDataSubject.next(null);return}}let{data:u,error:d}=yield z.from("Usuarios").insert([{authId:r,nombre:a||t.user.email,edad:l||0,avatarUrl:c}]).select().single();if(d){console.error("Error al insertar datos del usuario:",d.message),this.userDataSubject.next(null);return}this.userDataSubject.next(u)}else console.error("No hay datos temporales del usuario para insertar."),this.userDataSubject.next(null);else this.userDataSubject.next(s)}catch(s){console.error("Error al cargar los datos del usuario:",s),this.userDataSubject.next(null)}}),this.loadPromise})}logout(){return h(this,null,function*(){yield z.auth.signOut(),this.userDataSubject.next(null),this.loadPromise=null})}getAvatarUrl(t){return z.storage.from("imagenes").getPublicUrl(t).data.publicUrl}static \u0275fac=function(e){return new(e||i)};static \u0275prov=nt({token:i,factory:i.\u0275fac,providedIn:"root"})};export{rr as a,si as b,wt as c,Jr as d,Q as e,Fo as f,Uo as g,dn as h,gn as i,No as j,_n as k,yn as l,Lo as m,Bo as n,qo as o,z as p,js as q};
