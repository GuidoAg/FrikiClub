import{b as O,d as m,f as M,g as T,j as V,k as w,l as G,m as q,n as D,o as P,p as B,q as R}from"./chunk-WJLNC4RZ.js";import{a as j}from"./chunk-FF7POJ4O.js";import{a as U}from"./chunk-37WAIENX.js";import"./chunk-LJ5XHLMQ.js";import{j as k,k as N,l as I,p as A}from"./chunk-ODFDANH7.js";import{Ab as l,Bb as h,Ha as o,Jb as x,Kb as v,Ma as g,Sa as F,Xa as c,ca as _,da as y,db as s,kb as i,lb as n,mb as u,nb as S,rb as b,sb as p}from"./chunk-AWTQUO7P.js";import{h as C}from"./chunk-FK42CRUA.js";var E=(r,a)=>({"is-invalid":r,"is-valid":a}),$=r=>({"is-invalid":r});function z(r,a){if(r&1){let t=S();i(0,"div")(1,"input",19),b("change",function(d){_(t);let f=p();return y(f.onCheckboxChange(d))}),n(),i(2,"label",20),l(3),n()()}if(r&2){let t=a.$implicit,e=p();o(),s("id",t)("value",t)("checked",e.f.pregunta2.value.includes(t)),o(),s("for",t),o(),h(t)}}function L(r,a){r&1&&(i(0,"div",21),l(1," Seleccion\xE1 al menos una opci\xF3n. "),n())}function Q(r,a){if(r&1&&(i(0,"div"),u(1,"input",22),i(2,"label",20),l(3),n()()),r&2){let t=a.$implicit,e=p();o(),s("id","radio_"+t)("value",t)("ngClass",x(5,$,e.enviado&&e.f.pregunta3.invalid)),o(),s("for","radio_"+t),o(),h(t)}}function J(r,a){r&1&&(i(0,"div",23),l(1," Seleccion\xE1 una opci\xF3n. "),n())}function K(r,a){r&1&&(i(0,"div",24),l(1," \xA1Gracias por completar la encuesta! "),n())}var H=class r{constructor(a,t){this.fb=a;this.userService=t}encuestaForm;enviado=!1;guardadoExitoso=!1;opcionesCheckbox=["Busca minas","Ahorcado","Preguntado","Mayor menor"];opcionesRadio=["S\xED","No","Tal vez"];ngOnInit(){this.encuestaForm=this.fb.group({nombre:["",m.required],edad:["",[m.required,m.min(18),m.max(99)]],pregunta1:["",m.required],pregunta2:this.fb.array([],m.required),pregunta3:["",m.required]})}get f(){return this.encuestaForm.controls}onCheckboxChange(a){let t=this.encuestaForm.get("pregunta2"),e=a.target;if(e.checked)t.push(this.fb.control(e.value));else{let d=t.controls.findIndex(f=>f.value===e.value);d>=0&&t.removeAt(d)}}enviar(){return C(this,null,function*(){if(this.enviado=!0,this.guardadoExitoso=!1,this.encuestaForm.invalid)return;let a=this.userService.getCurrentUser();if(!a){alert("No se encontr\xF3 el usuario logueado");return}let t={usuario_id:a.id,nombre:this.f.nombre.value,edad:this.f.edad.value,pregunta1:this.f.pregunta1.value,pregunta2:this.f.pregunta2.value,pregunta3:this.f.pregunta3.value},{error:e}=yield U.from("Encuestas").insert([t]);if(e)console.error("Error al guardar encuesta:",e.message),alert("Hubo un error al guardar la encuesta");else{this.guardadoExitoso=!0,this.encuestaForm.reset(),this.enviado=!1;let d=this.encuestaForm.get("pregunta2");for(;d.length;)d.removeAt(0)}})}static \u0275fac=function(t){return new(t||r)(g(P),g(j))};static \u0275cmp=F({type:r,selectors:[["friki-club-home"]],decls:36,vars:18,consts:[[1,"encuesta-bg"],[1,"container","mt-4"],[1,"mb-4"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","nombre",1,"form-label"],["id","nombre","type","text","formControlName","nombre",1,"form-control",3,"ngClass"],[1,"invalid-feedback"],["for","edad",1,"form-label"],["id","edad","type","number","formControlName","edad",1,"form-control",3,"ngClass"],["for","pregunta1",1,"form-label"],["id","pregunta1","rows","3","formControlName","pregunta1",1,"form-control",3,"ngClass"],["for","pregunta2",1,"form-label","d-block"],[4,"ngFor","ngForOf"],["class","text-danger mt-1",4,"ngIf"],["for","pregunta3",1,"form-label","d-block"],["class","invalid-feedback d-block",4,"ngIf"],["type","submit",1,"btn","btn-primary"],["class","alert alert-success mt-3",4,"ngIf"],["type","checkbox",3,"change","id","value","checked"],[1,"ms-1",3,"for"],[1,"text-danger","mt-1"],["type","radio","formControlName","pregunta3",3,"id","value","ngClass"],[1,"invalid-feedback","d-block"],[1,"alert","alert-success","mt-3"]],template:function(t,e){t&1&&(i(0,"div",0)(1,"div",1)(2,"h2",2),l(3,"Encuesta"),n(),i(4,"form",3),b("ngSubmit",function(){return e.enviar()}),i(5,"div",4)(6,"label",5),l(7,"Nombre y Apellido"),n(),u(8,"input",6),i(9,"div",7),l(10,"El nombre es obligatorio."),n()(),i(11,"div",4)(12,"label",8),l(13,"Edad"),n(),u(14,"input",9),i(15,"div",7),l(16,"Debes tener entre 18 y 99 a\xF1os."),n()(),i(17,"div",4)(18,"label",10),l(19,"Opinion y recomendacion para la pagina"),n(),u(20,"textarea",11),i(21,"div",7),l(22,"Esta pregunta es obligatoria."),n()(),i(23,"div",4)(24,"label",12),l(25,"Que juegos recomendarias"),n(),c(26,z,4,5,"div",13)(27,L,2,0,"div",14),n(),i(28,"div",4)(29,"label",15),l(30,"\xBFVas a volver?"),n(),c(31,Q,4,7,"div",13)(32,J,2,0,"div",16),n(),i(33,"button",17),l(34,"Enviar encuesta"),n()(),c(35,K,2,0,"div",18),n()()),t&2&&(o(4),s("formGroup",e.encuestaForm),o(4),s("ngClass",v(9,E,e.enviado&&e.f.nombre.invalid,e.f.nombre.valid)),o(6),s("ngClass",v(12,E,e.enviado&&e.f.edad.invalid,e.f.edad.valid)),o(6),s("ngClass",v(15,E,e.enviado&&e.f.pregunta1.invalid,e.f.pregunta1.valid)),o(6),s("ngForOf",e.opcionesCheckbox),o(),s("ngIf",e.enviado&&(e.f.pregunta2.errors==null?null:e.f.pregunta2.errors.required)),o(4),s("ngForOf",e.opcionesRadio),o(),s("ngIf",e.enviado&&e.f.pregunta3.invalid),o(3),s("ngIf",e.guardadoExitoso))},dependencies:[A,k,N,I,R,V,O,w,G,M,T,q,D,B],styles:[".encuesta-bg[_ngcontent-%COMP%]{min-height:100vh;background-color:#c5c5c5;padding-top:2rem;padding-bottom:2rem;width:100%}html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{height:100%;margin:0;padding:0}"]})};export{H as EncuestaComponent};
