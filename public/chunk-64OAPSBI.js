import{p as T}from"./chunk-WJLNC4RZ.js";import{a as E}from"./chunk-GOHWGIN5.js";import{a as O}from"./chunk-BNY3LDWH.js";import{a as P}from"./chunk-FF7POJ4O.js";import"./chunk-37WAIENX.js";import"./chunk-LJ5XHLMQ.js";import{l as j,p as R}from"./chunk-ODFDANH7.js";import{Ab as s,Bb as I,Cb as S,Ea as C,Ha as c,Ma as v,Ob as w,Q as b,Sa as y,V as M,Xa as g,ca as m,da as u,db as d,kb as o,lb as n,mb as f,nb as h,rb as p,sb as l,zb as k}from"./chunk-AWTQUO7P.js";import"./chunk-FK42CRUA.js";var _=class a{constructor(t){this.http=t}baseUrl="https://deckofcardsapi.com/api/deck";deckId="";crearMazo(){return this.http.get(`${this.baseUrl}/new/shuffle/?deck_count=1`)}sacarCarta(t=1){return this.http.get(`${this.baseUrl}/${this.deckId}/draw/?count=${t}`)}setDeckId(t){this.deckId=t}getDeckId(){return this.deckId}static \u0275fac=function(e){return new(e||a)(M(E))};static \u0275prov=b({token:a,factory:a.\u0275fac,providedIn:"root"})};function z(a,t){a&1&&(o(0,"div",6)(1,"span",7),s(2,"Cargando..."),n()())}function D(a,t){if(a&1&&f(0,"img",14),a&2){let e=l(2);d("src",e.cartaRevelada?e.siguienteCarta.image:"https://deckofcardsapi.com/static/img/back.png",C)}}function N(a,t){a&1&&f(0,"img",15)}function J(a,t){if(a&1){let e=h();o(0,"div")(1,"button",16),p("click",function(){m(e);let r=l(2);return u(r.adivinar("mayor"))}),s(2," Mayor "),n(),o(3,"button",17),p("click",function(){m(e);let r=l(2);return u(r.adivinar("igual"))}),s(4," Igual "),n(),o(5,"button",18),p("click",function(){m(e);let r=l(2);return u(r.adivinar("menor"))}),s(6," Menor "),n()()}}function $(a,t){if(a&1){let e=h();o(0,"div")(1,"button",19),p("click",function(){m(e);let r=l(2);return u(r.siguienteRonda())}),s(2," Siguiente ronda "),n()()}}function F(a,t){if(a&1){let e=h();o(0,"div")(1,"button",20),p("click",function(){m(e);let r=l(2);return u(r.iniciarJuego())}),s(2," Reiniciar Juego "),n()()}}function H(a,t){if(a&1&&(o(0,"div")(1,"div",8)(2,"div",9)(3,"p",10),s(4,"Carta actual"),n(),f(5,"img",11),n(),o(6,"div",9)(7,"p",10),s(8,"Carta siguiente"),n(),g(9,D,1,1,"img",12)(10,N,1,0,"ng-template",null,0,w),n()(),g(12,J,7,0,"div",5),o(13,"div",13)(14,"h4"),s(15),n(),o(16,"p"),s(17),n()(),g(18,$,3,0,"div",5)(19,F,3,0,"div",5),n()),a&2){let e=k(11),i=l();c(5),d("src",i.cartaActual==null?null:i.cartaActual.image,C),c(4),d("ngIf",i.siguienteCarta)("ngIfElse",e),c(3),d("ngIf",!i.terminado&&!i.cartaRevelada),c(3),I(i.mensaje),c(2),S("Puntuaci\xF3n: ",i.puntaje,""),c(),d("ngIf",!i.terminado&&i.cartaRevelada),c(),d("ngIf",i.terminado)}}var A=class a{constructor(t,e,i){this.deckService=t;this.userService=e;this.puntajeService=i;this.preloadAudios()}cartaActual=null;siguienteCarta=null;cartasRestantes=[];puntaje=0;mensaje="";cargando=!1;terminado=!1;cartaRevelada=!1;audios={};ngOnInit(){this.iniciarJuego()}preloadAudios(){["punto","win"].forEach(e=>{let i=new Audio(`assets/sounds/${e}.mp3`);i.load(),this.audios[e]=i})}reproducirSonido(t){let e=this.audios[t];e&&(e.currentTime=0,e.volume=.5,e.play().catch(i=>console.error("Error sonido:",i)))}iniciarJuego(){this.cargando=!0,this.puntaje=0,this.mensaje="",this.terminado=!1,this.cartaRevelada=!1,this.cartasRestantes=[],this.cartaActual=null,this.siguienteCarta=null,this.deckService.crearMazo().subscribe(t=>{this.deckService.setDeckId(t.deck_id),this.deckService.sacarCarta(52).subscribe(e=>{this.cartasRestantes=e.cards,this.cartaActual=this.cartasRestantes.shift()||null,this.siguienteCarta=this.cartasRestantes.shift()||null,this.preloadCardImages(this.cartasRestantes),this.cargando=!1})})}adivinar(t){if(!this.cartaActual||!this.siguienteCarta||this.cartaRevelada||this.terminado)return;let e=this.valorCarta(this.cartaActual.value),i=this.valorCarta(this.siguienteCarta.value),r=!1;if(t==="mayor"?r=i>e:t==="menor"?r=i<e:t==="igual"&&(r=i===e),this.cartaRevelada=!0,r)this.mensaje=t==="igual"?"\xA1Correcto! (Iguales)":"\xA1Correcto!",this.puntaje+=t==="igual"?2:1,this.reproducirSonido("punto");else{this.mensaje="\xA1Incorrecto!",this.reproducirSonido("win"),this.terminado=!0;let x=this.userService.getCurrentUser();x&&this.puntajeService.guardarPuntaje(x,"mayormenor",this.puntaje)}}siguienteRonda(){if(!(!this.cartaRevelada||this.terminado)&&(this.cartaActual=this.siguienteCarta,this.siguienteCarta=this.cartasRestantes.shift()||null,this.mensaje="",this.cartaRevelada=!1,!this.siguienteCarta)){this.terminado=!0,this.mensaje="\xA1Ganaste! Se terminaron las cartas del mazo \u{1F389}",this.reproducirSonido("win");let t=this.userService.getCurrentUser();t&&this.puntajeService.guardarPuntaje(t,"mayormenor",this.puntaje)}}valorCarta(t){return{ACE:14,KING:13,QUEEN:12,JACK:11}[t]??parseInt(t,10)}preloadCardImages(t){t.forEach(e=>{let i=new Image;i.src=e.image})}static \u0275fac=function(e){return new(e||a)(v(_),v(P),v(O))};static \u0275cmp=y({type:a,selectors:[["friki-club-mayor-menor"]],decls:6,vars:2,consts:[["cartaTapada",""],[1,"container","text-center"],[1,"card","p-4","shadow-lg","rounded-4","bg-dark","text-white"],[1,"mb-3"],["class","spinner-border text-light my-3","role","status",4,"ngIf"],[4,"ngIf"],["role","status",1,"spinner-border","text-light","my-3"],[1,"visually-hidden"],[1,"row","justify-content-center","mb-4"],[1,"col-6","col-md-5","text-center"],[1,"text-muted"],["alt","Carta actual",1,"img-fluid","carta-img",3,"src"],["alt","Carta siguiente","class","img-fluid carta-img",3,"src",4,"ngIf","ngIfElse"],[1,"mt-3"],["alt","Carta siguiente",1,"img-fluid","carta-img",3,"src"],["src","https://deckofcardsapi.com/static/img/back.png","alt","Carta siguiente",1,"img-fluid","carta-img"],[1,"btn","btn-success","me-2",3,"click"],[1,"btn","btn-warning","me-2",3,"click"],[1,"btn","btn-danger",3,"click"],[1,"btn","btn-light","mt-2",3,"click"],[1,"btn","btn-primary","mt-3",3,"click"]],template:function(e,i){e&1&&(o(0,"div",1)(1,"div",2)(2,"h2",3),s(3,"Juego: Mayor o Menor"),n(),g(4,z,3,0,"div",4)(5,H,20,8,"div",5),n()()),e&2&&(c(4),d("ngIf",i.cargando),c(),d("ngIf",!i.cargando))},dependencies:[R,j,T],styles:["html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{height:100%}.container[_ngcontent-%COMP%]{max-width:700px;padding:2rem;min-height:90vh;display:flex;flex-direction:column;justify-content:center}.card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1e1e2f,#2c2c3c);border:none}button[_ngcontent-%COMP%]{min-width:140px;font-size:1.4rem}.carta-img[_ngcontent-%COMP%]{max-height:200px;border-radius:1rem;box-shadow:0 4px 10px #00000080;transition:transform .2s ease}h2[_ngcontent-%COMP%], h4[_ngcontent-%COMP%]{font-weight:600;color:#fff}.carta-img-revelada[_ngcontent-%COMP%]{max-height:220px;border-radius:1rem;border:2px solid #ff4444;box-shadow:0 0 15px #f449}"]})};export{A as MayorMenorComponent};
